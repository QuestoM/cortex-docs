
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Enterprise AI Agent SDK - Brain-inspired, goal-driven, on-prem ready">
      
      
      
        <link rel="canonical" href="https://docs.cortex-ai.com/decision_theory_research/">
      
      
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.3">
    
    
      
        <title>Decision Theory, Game Theory & Bayesian Mathematics for corteX - corteX Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="amber">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#decision-theory-game-theory-bayesian-mathematics-for-cortex" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="corteX Documentation" class="md-header__button md-logo" aria-label="corteX Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            corteX Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Decision Theory, Game Theory &amp; Bayesian Mathematics for corteX
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="amber"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="amber"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../getting-started/" class="md-tabs__link">
          
  
  
    
  
  Getting Started

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../tutorials/" class="md-tabs__link">
          
  
  
    
  
  Tutorials

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../concepts/" class="md-tabs__link">
          
  
  
    
  
  Concepts

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../guides/" class="md-tabs__link">
          
  
  
    
  
  How-To Guides

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../enterprise/" class="md-tabs__link">
          
  
  
    
  
  Enterprise

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../reference/" class="md-tabs__link">
          
  
  
    
  
  API Reference

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../changelog/" class="md-tabs__link">
        
  
  
    
  
  Changelog

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="corteX Documentation" class="md-nav__button md-logo" aria-label="corteX Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    corteX Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../getting-started/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Getting Started
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quick Start
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/first-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Your First Agent
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/adding-tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Adding Tools
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/streaming/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Streaming Responses
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../tutorials/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Tutorials
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Tutorials
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/support-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Customer Support Agent
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/code-review-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Code Review Agent
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/research-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Research Agent
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/multi-provider/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Multi-Provider Failover
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/production/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Deploy to Production
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../concepts/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Concepts
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Concepts
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Architecture Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/engine-v2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Agentic Engine Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../concepts/brain/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    The Brain Engine
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    The Brain Engine
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/brain/weights/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Synaptic Weights
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/brain/goal-tracking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Goal Tracking
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/brain/dual-process/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Dual-Process Routing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/brain/prediction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Prediction & Surprise
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/brain/feedback/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Feedback System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/brain/plasticity/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Plasticity & Learning
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/brain/adaptation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sensory Adaptation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/brain/brain-llm-bridge/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Brain-LLM Bridge
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/brain/neurollama-architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    NeuroLlama Architecture
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../concepts/context/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Context & Memory
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_5" id="__nav_4_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Context & Memory
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/context/context-engine/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cortical Context Engine
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/context/memory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Memory Fabric
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/context/cross-modal/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cross-Modal Association
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_6" >
        
          
          <label class="md-nav__link" for="__nav_4_6" id="__nav_4_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Cognitive Systems
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Cognitive Systems
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/cognitive-context/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cognitive Context Pipeline
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/agent-intelligence/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Agent Intelligence
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/goal-intelligence/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Goal Intelligence
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/model-routing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Intelligent Model Routing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/anti-drift/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Anti-Drift System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/security/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Security Framework
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/observability/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Observability
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_7" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../concepts/advanced/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Advanced Subsystems
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_7" id="__nav_4_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Advanced Subsystems
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/advanced/attention/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Attention & Filtering
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/advanced/columns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cortical Columns
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/advanced/resource-map/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Resource Allocation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/advanced/concept-graphs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Concept Graphs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/advanced/calibration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Calibration & Metacognition
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/advanced/modulation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Targeted Modulation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/advanced/reorganization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Map Reorganization
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/advanced/population/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Population Estimation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/advanced/simulation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Component Simulation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/advanced/structured-output/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Structured Output
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/advanced/content-prediction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Content-Aware Predictions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/advanced/game-integration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Game Theory Integration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/advanced/context-summarizer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Context Summarization
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/advanced/semantic-scorer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Semantic Scoring
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_8" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../concepts/interop/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Interoperability
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_8" id="__nav_4_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Interoperability
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/interop/mcp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MCP - Model Context Protocol
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/interop/a2a/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    A2A - Agent-to-Agent Protocol
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/llm-routing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LLM Routing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/tool-reputation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tool Reputation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../guides/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    How-To Guides
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    How-To Guides
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    LLM Providers
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    LLM Providers
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/providers/openai/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Connect to OpenAI
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/providers/gemini/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Connect to Google Gemini
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/providers/anthropic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Connect to Anthropic Claude
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/providers/local-models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Use Local Models
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/providers/switching-providers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Switch Between Providers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Configuration
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Configuration
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/config/weight-tuning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tune Agent Weights
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/config/context-profiles/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configure Context Profiles
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/config/temperature/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Control Temperature &amp; Creativity
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/config/brain-parameters/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    How to Configure Brain-to-LLM Parameter Mapping
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/config/inference-hooks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    How to Configure Inference-Time Brain Hooks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_4" >
        
          
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Tools
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Tools
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/tools/custom-tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Create Custom Tools
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/tools/tool-reputation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Manage Tool Reputation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_5" >
        
          
          <label class="md-nav__link" for="__nav_5_5" id="__nav_5_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Interop
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Interop
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/interop/mcp-servers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Connect to MCP Servers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/interop/a2a-agents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Delegate Tasks to A2A Agents
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_6" >
        
          
          <label class="md-nav__link" for="__nav_5_6" id="__nav_5_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Advanced
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Advanced
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/advanced/what-if-simulation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Run What-If Simulations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/advanced/modulation-overrides/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Override with Targeted Modulation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/advanced/weight-persistence/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Persist Weights Across Sessions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../guides/advanced/observability/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Monitor Your Agent
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../enterprise/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Enterprise
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6" id="__nav_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Enterprise
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../enterprise/multi-tenant/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Multi-Tenant Setup
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../enterprise/security/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Security & Isolation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../enterprise/safety/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Safety Controls
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../enterprise/audit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Audit Logging
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../enterprise/compliance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Compliance
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../enterprise/compliance-overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Compliance Overview (SOC 2 + GDPR)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../enterprise/licensing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Licensing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../enterprise/on-prem/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    On-Premises Deployment
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../enterprise/updates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Updates & Versioning
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../reference/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7" id="__nav_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    API Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2" >
        
          
          <label class="md-nav__link" for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Public API
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Public API
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/engine/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Engine API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Agent API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/session/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Session API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/response/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Response &amp; Configuration API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_3" >
        
          
          <label class="md-nav__link" for="__nav_7_3" id="__nav_7_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Core Modules
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Core Modules
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/core/events/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    EventBus API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/core/contracts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contracts API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/core/registry/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Plugin Registry API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_4" >
        
          
          <label class="md-nav__link" for="__nav_7_4" id="__nav_7_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Engine Modules
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Engine Modules
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_4_1" >
        
          
          <label class="md-nav__link" for="__nav_7_4_1" id="__nav_7_4_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Brain Core
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_4_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Brain Core
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/engine/weights/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Weight Engine
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/engine/goal-tracker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Goal Tracker
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/engine/feedback/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Feedback Engine
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/engine/prediction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Prediction Engine
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/engine/plasticity/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Plasticity Manager
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/engine/adaptation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Adaptation Filter
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/engine/game-theory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Game Theory
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/engine/context/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cortical Context Engine
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/engine/memory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Memory
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/engine/bayesian/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Bayesian Mathematics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/engine/calibration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Calibration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/engine/columns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Columns
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/engine/concepts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Concepts
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/engine/cross-modal/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cross-Modal
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/engine/attention/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Attention
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/engine/resource-map/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Resource Map
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/engine/proactive/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Proactive
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/engine/population/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Population
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_4_2" >
        
          
          <label class="md-nav__link" for="__nav_7_4_2" id="__nav_7_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Brain-LLM Bridge
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_4_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Brain-LLM Bridge
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/engine/brain-state-injector/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Brain State Injector API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/engine/parameter-resolver/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Brain Parameter Resolver API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/engine/inference-hooks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Inference Hooks (Layer 2) API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/engine/context-summarizer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Context Summarizer API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_4_3" >
        
          
          <label class="md-nav__link" for="__nav_7_4_3" id="__nav_7_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Agent Intelligence
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_4_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Agent Intelligence
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/engine/model-mosaic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Model Mosaic API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/engine/speculative-executor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Speculative Executor API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/engine/decision-log/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Decision Log API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/engine/progress-estimator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Progress Estimator API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/engine/ab-test-manager/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    A/B Test Manager API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/engine/provider-health/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Provider Health Monitor API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_4_4" >
        
          
          <label class="md-nav__link" for="__nav_7_4_4" id="__nav_7_4_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Agentic Engine
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_4_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Agentic Engine
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/engine/agent-loop/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Agent Loop API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/engine/context-compiler/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Context Compiler API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/engine/planner/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Planning Engine API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/engine/reflection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Reflection Engine API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/engine/recovery/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Recovery Engine API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/engine/interaction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Interaction Manager API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/engine/policy-engine/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Policy Engine API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/engine/sub-agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sub-Agent Manager API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_4_5" >
        
          
          <label class="md-nav__link" for="__nav_7_4_5" id="__nav_7_4_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Goal System
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_4_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Goal System
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/engine/goal-tree/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Goal Tree API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/engine/goal-dna/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Goal DNA API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/engine/goal-reminder/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Goal Reminder Injector API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_4_6" >
        
          
          <label class="md-nav__link" for="__nav_7_4_6" id="__nav_7_4_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Anti-Drift
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_4_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_4_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Anti-Drift
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/engine/drift-engine/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Drift Detection Engine API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/engine/loop-detector/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Loop Detector API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/engine/adaptive-budget/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Adaptive Budget Engine API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_4_7" >
        
          
          <label class="md-nav__link" for="__nav_7_4_7" id="__nav_7_4_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Advanced Engine
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_4_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_4_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Advanced Engine
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/engine/simulator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Component Simulator API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/engine/reorganization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cortical Map Reorganizer API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/engine/modulator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Targeted Modulator API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/engine/structured-output/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Structured Output API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/engine/content-prediction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Content Prediction API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/engine/semantic-scorer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Semantic Importance Scorer API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_5" >
        
          
          <label class="md-nav__link" for="__nav_7_5" id="__nav_7_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    NeuroLlama
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    NeuroLlama
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/neurollama/neurollama-model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    NeuroLlama API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_6" >
        
          
          <label class="md-nav__link" for="__nav_7_6" id="__nav_7_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Enterprise
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Enterprise
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/enterprise/config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Enterprise Config API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/enterprise/licensing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    License Manager API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/enterprise/updates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Update Manager API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/enterprise/consent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Consent Manager
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/enterprise/gdpr/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GDPR Manager
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/enterprise/retention/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Retention Manager
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/enterprise/profiling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Profiling Manager
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/enterprise/explainability/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Explainability Engine
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/enterprise/data-residency/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data Residency
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_7" >
        
          
          <label class="md-nav__link" for="__nav_7_7" id="__nav_7_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Tools
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Tools
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/tools/decorator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tool Decorator API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/tools/executor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tool Executor API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_8" >
        
          
          <label class="md-nav__link" for="__nav_7_8" id="__nav_7_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    LLM Layer
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    LLM Layer
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/llm/router/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LLM Router API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/llm/base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    LLM Base API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/llm/openai-client/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    OpenAI Provider API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/llm/gemini-client/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Gemini Provider API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/llm/anthropic-client/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Anthropic Provider API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/llm/classifier/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cognitive Classifier API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/llm/cost-tracker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cost Tracker API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/llm/registry/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Model Registry API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/llm/resilience/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Resilience Primitives API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_9" >
        
          
          <label class="md-nav__link" for="__nav_7_9" id="__nav_7_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Cognitive Context
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    Cognitive Context
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/cognitive/entanglement/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Entanglement Graph
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/cognitive/pyramid/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Context Pyramid
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/cognitive/predictive-loader/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Predictive Pre-Loader
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/cognitive/crystallizer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Memory Crystallizer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/cognitive/active-forgetting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Active Forgetting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/cognitive/versioner/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Context Versioner
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/cognitive/density-optimizer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Density Optimizer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/cognitive/context-quality/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Context Quality Engine
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/cognitive/state-files/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    State File Manager
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/cognitive/cognitive-pipeline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cognitive Pipeline
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_10" >
        
          
          <label class="md-nav__link" for="__nav_7_10" id="__nav_7_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Security
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    Security
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/security/vault/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Key Vault
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/security/capabilities/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Capability Set
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/security/attenuation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Risk Attenuator
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/security/classification/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data Classifier
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/security/compliance/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Compliance Engine
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/security/audit-logger/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Audit Logger
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/security/pii-tokenizer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PII Tokenizer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/security/tenant-encryption/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tenant Encryption
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_11" >
        
          
          <label class="md-nav__link" for="__nav_7_11" id="__nav_7_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Tenancy
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_11">
            <span class="md-nav__icon md-icon"></span>
            
  
    Tenancy
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/tenancy/manager/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tenant Manager
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/tenancy/dna/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tenant DNA
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/tenancy/quota/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quota Tracker
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_12" >
        
          
          <label class="md-nav__link" for="__nav_7_12" id="__nav_7_12_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Observability
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_12">
            <span class="md-nav__icon md-icon"></span>
            
  
    Observability
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/observability/tracer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Decision Tracer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/observability/cost-predictor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cost Predictor
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/observability/metrics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Metrics Collector
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/observability/audit-stream/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Audit Stream
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_13" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../reference/interop/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Interop
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7_13" id="__nav_7_13_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_13">
            <span class="md-nav__icon md-icon"></span>
            
  
    Interop
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/interop/types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Types
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/interop/mcp-client/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MCP Client
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/interop/mcp-tool-bridge/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MCP Tool Bridge
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/interop/mcp-transport/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MCP Transport
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/interop/mcp-resource-bridge/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    MCP Resource Bridge
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/interop/a2a-client/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    A2A Client
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/interop/a2a-agent-card/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    A2A Agent Card
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/interop/a2a-task-bridge/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    A2A Task Bridge
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../changelog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Changelog
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#research-document-enhancing-the-brain-inspired-weight-engine" class="md-nav__link">
    <span class="md-ellipsis">
      
        Research Document: Enhancing the Brain-Inspired Weight Engine
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" class="md-nav__link">
    <span class="md-ellipsis">
      
        Table of Contents
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-i-kahnemans-decision-theory" class="md-nav__link">
    <span class="md-ellipsis">
      
        Part I: Kahneman's Decision Theory
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Part I: Kahneman&#39;s Decision Theory">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-system-1-vs-system-2-dual-process-theory-for-agent-decisions" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.1 System 1 vs. System 2: Dual-Process Theory for Agent Decisions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-prospect-theory-loss-aversion-in-weight-updates" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.2 Prospect Theory: Loss Aversion in Weight Updates
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-anchoring-bias-initial-weights-shape-future-behavior" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.3 Anchoring Bias: Initial Weights Shape Future Behavior
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14-availability-heuristic-recency-bias-in-memory" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.4 Availability Heuristic: Recency Bias in Memory
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15-framing-effects-how-context-shapes-decisions" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.5 Framing Effects: How Context Shapes Decisions
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-ii-game-theory-for-multi-agent-decision-making" class="md-nav__link">
    <span class="md-ellipsis">
      
        Part II: Game Theory for Multi-Agent Decision Making
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Part II: Game Theory for Multi-Agent Decision Making">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-nash-equilibrium-stable-toolmodel-selection-strategies" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1 Nash Equilibrium: Stable Tool/Model Selection Strategies
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-minimax-risk-minimization-for-high-stakes-decisions" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2 Minimax: Risk Minimization for High-Stakes Decisions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-mechanism-design-truthful-capability-reporting" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.3 Mechanism Design: Truthful Capability Reporting
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24-cooperative-game-theory-shapley-values-for-attribution" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.4 Cooperative Game Theory: Shapley Values for Attribution
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#25-repeated-games-learning-tool-reliability-over-time" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.5 Repeated Games: Learning Tool Reliability Over Time
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#26-bayesian-games-decisions-under-incomplete-information" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.6 Bayesian Games: Decisions Under Incomplete Information
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#part-iii-bayesian-mathematics-for-probabilistic-weight-updates" class="md-nav__link">
    <span class="md-ellipsis">
      
        Part III: Bayesian Mathematics for Probabilistic Weight Updates
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Part III: Bayesian Mathematics for Probabilistic Weight Updates">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-bayesian-updating-from-ema-to-proper-posterior-inference" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.1 Bayesian Updating: From EMA to Proper Posterior Inference
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-thompson-sampling-exploration-vs-exploitation" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.2 Thompson Sampling: Exploration vs. Exploitation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-bayesian-optimization-hyperparameter-tuning" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.3 Bayesian Optimization: Hyperparameter Tuning
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-conjugate-priors-the-right-distribution-for-each-data-type" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.4 Conjugate Priors: The Right Distribution for Each Data Type
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#35-multi-armed-bandits-ucb1-alternative-to-thompson-sampling" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.5 Multi-Armed Bandits: UCB1 Alternative to Thompson Sampling
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#36-bayesian-surprise-formalizing-the-prediction-error-signal" class="md-nav__link">
    <span class="md-ellipsis">
      
        3.6 Bayesian Surprise: Formalizing the Prediction Error Signal
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#integration-map" class="md-nav__link">
    <span class="md-ellipsis">
      
        Integration Map
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Integration Map">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#where-each-pattern-fits-in-the-cortex-codebase" class="md-nav__link">
    <span class="md-ellipsis">
      
        Where Each Pattern Fits in the corteX Codebase
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-flow" class="md-nav__link">
    <span class="md-ellipsis">
      
        Data Flow
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#priority-ranking" class="md-nav__link">
    <span class="md-ellipsis">
      
        Priority Ranking
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Priority Ranking">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#impact-vs-complexity-matrix" class="md-nav__link">
    <span class="md-ellipsis">
      
        Impact vs. Complexity Matrix
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recommended-implementation-order" class="md-nav__link">
    <span class="md-ellipsis">
      
        Recommended Implementation Order
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mathematical-reference-key-formulas" class="md-nav__link">
    <span class="md-ellipsis">
      
        Mathematical Reference: Key Formulas
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Mathematical Reference: Key Formulas">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prospect-theory-value-function" class="md-nav__link">
    <span class="md-ellipsis">
      
        Prospect Theory Value Function
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#beta-bernoulli-posterior-update" class="md-nav__link">
    <span class="md-ellipsis">
      
        Beta-Bernoulli Posterior Update
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#thompson-sampling-selection" class="md-nav__link">
    <span class="md-ellipsis">
      
        Thompson Sampling Selection
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ucb1-selection" class="md-nav__link">
    <span class="md-ellipsis">
      
        UCB1 Selection
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bayesian-surprise-kl-divergence" class="md-nav__link">
    <span class="md-ellipsis">
      
        Bayesian Surprise (KL Divergence)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shapley-value" class="md-nav__link">
    <span class="md-ellipsis">
      
        Shapley Value
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nash-equilibrium-best-response" class="md-nav__link">
    <span class="md-ellipsis">
      
        Nash Equilibrium Best Response
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#expected-improvement-bayesian-optimization" class="md-nav__link">
    <span class="md-ellipsis">
      
        Expected Improvement (Bayesian Optimization)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gamma-exponential-posterior-update" class="md-nav__link">
    <span class="md-ellipsis">
      
        Gamma-Exponential Posterior Update
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      
        References
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="References">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kahnemans-decision-theory" class="md-nav__link">
    <span class="md-ellipsis">
      
        Kahneman's Decision Theory
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#game-theory" class="md-nav__link">
    <span class="md-ellipsis">
      
        Game Theory
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bayesian-mathematics" class="md-nav__link">
    <span class="md-ellipsis">
      
        Bayesian Mathematics
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#computational-neuroscience" class="md-nav__link">
    <span class="md-ellipsis">
      
        Computational Neuroscience
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#applied-research-2025-2026" class="md-nav__link">
    <span class="md-ellipsis">
      
        Applied Research (2025-2026)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="decision-theory-game-theory-bayesian-mathematics-for-cortex">Decision Theory, Game Theory &amp; Bayesian Mathematics for corteX<a class="headerlink" href="#decision-theory-game-theory-bayesian-mathematics-for-cortex" title="Permanent link">&para;</a></h1>
<h2 id="research-document-enhancing-the-brain-inspired-weight-engine">Research Document: Enhancing the Brain-Inspired Weight Engine<a class="headerlink" href="#research-document-enhancing-the-brain-inspired-weight-engine" title="Permanent link">&para;</a></h2>
<p><strong>Author</strong>: corteX Research Agent
<strong>Date</strong>: 2026-02-09
<strong>Status</strong>: Research Complete -- Ready for Implementation Planning</p>
<hr />
<h2 id="table-of-contents">Table of Contents<a class="headerlink" href="#table-of-contents" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="#part-i-kahnemans-decision-theory">Part I: Kahneman's Decision Theory for AI Agent Weights</a></li>
<li><a href="#part-ii-game-theory">Part II: Game Theory for Multi-Agent Decision Making</a></li>
<li><a href="#part-iii-bayesian-mathematics">Part III: Bayesian Mathematics for Probabilistic Weight Updates</a></li>
<li><a href="#integration-map">Integration Map: Where Each Pattern Fits in corteX</a></li>
<li><a href="#priority-ranking">Priority Ranking</a></li>
<li><a href="#references">References</a></li>
</ol>
<hr />
<h2 id="part-i-kahnemans-decision-theory">Part I: Kahneman's Decision Theory<a class="headerlink" href="#part-i-kahnemans-decision-theory" title="Permanent link">&para;</a></h2>
<h3 id="11-system-1-vs-system-2-dual-process-theory-for-agent-decisions">1.1 System 1 vs. System 2: Dual-Process Theory for Agent Decisions<a class="headerlink" href="#11-system-1-vs-system-2-dual-process-theory-for-agent-decisions" title="Permanent link">&para;</a></h3>
<p><strong>Theoretical Background</strong></p>
<p>Daniel Kahneman's dual-process theory (Thinking, Fast and Slow) describes two
modes of cognition:</p>
<ul>
<li><strong>System 1</strong>: Fast, automatic, intuitive, low-effort. Operates on pattern
  recognition and heuristics. Always active.</li>
<li><strong>System 2</strong>: Slow, deliberate, analytical, high-effort. Engages when System 1
  encounters novelty, complexity, or high stakes.</li>
</ul>
<p>The brain does not always engage System 2 -- doing so would be metabolically
prohibitive. Instead, System 1 handles ~98% of decisions, and System 2 activates
only when surprise, conflict, or high stakes are detected.</p>
<p><strong>Mapping to corteX Agent Architecture</strong></p>
<table>
<thead>
<tr>
<th>Brain System</th>
<th>corteX Equivalent</th>
<th>Implementation</th>
</tr>
</thead>
<tbody>
<tr>
<td>System 1 (Fast)</td>
<td>Cached patterns, weight lookups, heuristic routing</td>
<td><code>PopulationDecoder</code>, <code>ToolPreferenceWeights.get_best_tool()</code></td>
</tr>
<tr>
<td>System 2 (Slow)</td>
<td>Full LLM reasoning, multi-step planning, deep analysis</td>
<td><code>LLMRouter.generate()</code> with <code>thinking=True</code>, <code>GoalTracker.verify_step()</code></td>
</tr>
<tr>
<td>Conflict monitor (ACC)</td>
<td>Surprise signal magnitude</td>
<td><code>PredictionEngine.compare()</code> -&gt; <code>SurpriseSignal</code></td>
</tr>
<tr>
<td>Engagement threshold</td>
<td>When to escalate from S1 to S2</td>
<td>New: <code>DualProcessRouter</code> class</td>
</tr>
</tbody>
</table>
<p><strong>Concrete SDK Pattern: <code>DualProcessRouter</code></strong></p>
<p>The agent should use System 1 (fast path) by default, and escalate to System 2
(slow path) when specific triggers are met:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">DualProcessRouter</span><span class="p">:</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="sd">    Routes decisions through fast (System 1) or slow (System 2) paths.</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="sd">    Escalation triggers:</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="sd">    1. Surprise magnitude &gt; threshold (prediction error)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="sd">    2. Task novelty &gt; threshold (no cached pattern)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="sd">    3. Stakes level &gt; threshold (enterprise safety)</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="sd">    4. Conflict detected (population disagreement)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="sd">    5. Explicit user request for careful analysis</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">weight_engine</span><span class="p">:</span> <span class="n">WeightEngine</span><span class="p">,</span> <span class="n">prediction_engine</span><span class="p">:</span> <span class="n">PredictionEngine</span><span class="p">):</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="o">=</span> <span class="n">weight_engine</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">predictor</span> <span class="o">=</span> <span class="n">prediction_engine</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">escalation_threshold</span> <span class="o">=</span> <span class="mf">0.6</span>  <span class="c1"># Surprise level to trigger S2</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">novelty_threshold</span> <span class="o">=</span> <span class="mf">0.7</span>     <span class="c1"># How unfamiliar the pattern is</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stakes_threshold</span> <span class="o">=</span> <span class="mf">0.8</span>      <span class="c1"># Enterprise safety concern</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">should_escalate</span><span class="p">(</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>        <span class="n">surprise</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">SurpriseSignal</span><span class="p">],</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>        <span class="n">population_agreement</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>        <span class="n">task_novelty</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>        <span class="n">enterprise_safety</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Determine if System 2 engagement is needed.&quot;&quot;&quot;</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>        <span class="c1"># High surprise = prediction was wrong = need deeper analysis</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>        <span class="k">if</span> <span class="n">surprise</span> <span class="ow">and</span> <span class="n">surprise</span><span class="o">.</span><span class="n">surprise_magnitude</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">escalation_threshold</span><span class="p">:</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>            <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a>        <span class="c1"># Low population agreement = evaluators disagree = uncertain</span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a>        <span class="k">if</span> <span class="n">population_agreement</span> <span class="o">&lt;</span> <span class="mf">0.4</span><span class="p">:</span>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a>            <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a>        <span class="c1"># Novel task with no cached patterns</span>
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a>        <span class="k">if</span> <span class="n">task_novelty</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">novelty_threshold</span><span class="p">:</span>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a>            <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a>        <span class="c1"># High-stakes enterprise context</span>
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a>        <span class="k">if</span> <span class="n">enterprise_safety</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">stakes_threshold</span><span class="p">:</span>
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a>            <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a>        <span class="k">return</span> <span class="kc">False</span>
<a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a>
<a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">route</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns &#39;system1&#39; or &#39;system2&#39;.&quot;&quot;&quot;</span>
<a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">should_escalate</span><span class="p">(</span><span class="o">**</span><span class="n">context</span><span class="p">):</span>
<a id="__codelineno-0-44" name="__codelineno-0-44" href="#__codelineno-0-44"></a>            <span class="k">return</span> <span class="s2">&quot;system2&quot;</span>
<a id="__codelineno-0-45" name="__codelineno-0-45" href="#__codelineno-0-45"></a>        <span class="k">return</span> <span class="s2">&quot;system1&quot;</span>
</code></pre></div>
<p><strong>Integration Point</strong>: <code>corteX/engine/prediction.py</code> -&gt; New file
<code>corteX/engine/dual_process.py</code>. Called from <code>corteX/runtime/orchestrator.py</code>
before each LLM call. When System 1, use <code>prefer_speed=True</code> on the router.
When System 2, use <code>thinking=True</code> with full reasoning budget.</p>
<h3 id="12-prospect-theory-loss-aversion-in-weight-updates">1.2 Prospect Theory: Loss Aversion in Weight Updates<a class="headerlink" href="#12-prospect-theory-loss-aversion-in-weight-updates" title="Permanent link">&para;</a></h3>
<p><strong>Theoretical Background</strong></p>
<p>Kahneman and Tversky's Prospect Theory (1979) identifies three key departures
from rational utility theory:</p>
<ol>
<li><strong>Reference Dependence</strong>: Value is perceived relative to a reference point,
   not in absolute terms.</li>
<li><strong>Loss Aversion</strong>: Losses loom larger than gains. The pain of losing $100 is
   approximately 2-2.5x the pleasure of gaining $100.</li>
<li><strong>Diminishing Sensitivity</strong>: The marginal impact of gains/losses decreases
   as their magnitude increases.</li>
</ol>
<p><strong>The Value Function</strong></p>
<p>The prospect theory value function is defined as:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>v(x) = x^alpha           if x &gt;= 0  (gains)
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>v(x) = -lambda * |x|^beta    if x &lt; 0   (losses)
</code></pre></div>
<p>Where:
- <code>alpha ~= 0.88</code> (diminishing sensitivity for gains)
- <code>beta ~= 0.88</code> (diminishing sensitivity for losses)
- <code>lambda ~= 2.25</code> (loss aversion coefficient)
- <code>x</code> = deviation from reference point</p>
<p><strong>The Probability Weighting Function</strong></p>
<p>Prospect theory also transforms probabilities through a weighting function:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>w(p) = p^gamma / (p^gamma + (1-p)^gamma)^(1/gamma)
</code></pre></div>
<p>Where <code>gamma ~= 0.61</code> (Tversky &amp; Kahneman, 1992). This overweights small
probabilities and underweights large ones -- explaining why agents should pay
outsized attention to rare failures.</p>
<p><strong>Application to corteX Weight Updates</strong></p>
<p>Currently, <code>ToolPreferenceWeights.record_use()</code> uses symmetric EMA:
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="n">t</span><span class="p">[</span><span class="s2">&quot;success_rate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="s2">&quot;success_rate&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0</span> <span class="k">if</span> <span class="n">success</span> <span class="k">else</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span>
</code></pre></div></p>
<p>This treats successes and failures symmetrically. Prospect theory demands
asymmetry.</p>
<p><strong>Concrete SDK Pattern: <code>ProspectTheoreticUpdater</code></strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">ProspectTheoreticUpdater</span><span class="p">:</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="sd">    Applies Kahneman-Tversky prospect theory to weight updates.</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="sd">    Failures (losses) are weighted 2.25x more than successes (gains).</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>        <span class="n">loss_aversion</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.25</span><span class="p">,</span>   <span class="c1"># lambda</span>
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>        <span class="n">gain_sensitivity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.88</span><span class="p">,</span> <span class="c1"># alpha</span>
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>        <span class="n">loss_sensitivity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.88</span><span class="p">,</span> <span class="c1"># beta</span>
<a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a>    <span class="p">):</span>
<a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">loss_aversion</span> <span class="o">=</span> <span class="n">loss_aversion</span>
<a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">gain_sensitivity</span> <span class="o">=</span> <span class="n">gain_sensitivity</span>
<a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">loss_sensitivity</span> <span class="o">=</span> <span class="n">loss_sensitivity</span>
<a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a>
<a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">compute_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outcome_delta</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">reference_point</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a><span class="sd">        Compute the subjective value of an outcome relative to reference.</span>
<a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a><span class="sd">        outcome_delta &gt; 0 = gain (success), &lt; 0 = loss (failure)</span>
<a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-4-22" name="__codelineno-4-22" href="#__codelineno-4-22"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">outcome_delta</span> <span class="o">-</span> <span class="n">reference_point</span>
<a id="__codelineno-4-23" name="__codelineno-4-23" href="#__codelineno-4-23"></a>        <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-4-24" name="__codelineno-4-24" href="#__codelineno-4-24"></a>            <span class="k">return</span> <span class="n">x</span> <span class="o">**</span> <span class="bp">self</span><span class="o">.</span><span class="n">gain_sensitivity</span>
<a id="__codelineno-4-25" name="__codelineno-4-25" href="#__codelineno-4-25"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-4-26" name="__codelineno-4-26" href="#__codelineno-4-26"></a>            <span class="k">return</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">loss_aversion</span> <span class="o">*</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">**</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss_sensitivity</span><span class="p">)</span>
<a id="__codelineno-4-27" name="__codelineno-4-27" href="#__codelineno-4-27"></a>
<a id="__codelineno-4-28" name="__codelineno-4-28" href="#__codelineno-4-28"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">asymmetric_update</span><span class="p">(</span>
<a id="__codelineno-4-29" name="__codelineno-4-29" href="#__codelineno-4-29"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-4-30" name="__codelineno-4-30" href="#__codelineno-4-30"></a>        <span class="n">current_weight</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-4-31" name="__codelineno-4-31" href="#__codelineno-4-31"></a>        <span class="n">success</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
<a id="__codelineno-4-32" name="__codelineno-4-32" href="#__codelineno-4-32"></a>        <span class="n">learning_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.08</span><span class="p">,</span>
<a id="__codelineno-4-33" name="__codelineno-4-33" href="#__codelineno-4-33"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-4-34" name="__codelineno-4-34" href="#__codelineno-4-34"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-4-35" name="__codelineno-4-35" href="#__codelineno-4-35"></a><span class="sd">        Update weight with loss-aversion asymmetry.</span>
<a id="__codelineno-4-36" name="__codelineno-4-36" href="#__codelineno-4-36"></a><span class="sd">        A single failure has 2.25x the impact of a single success.</span>
<a id="__codelineno-4-37" name="__codelineno-4-37" href="#__codelineno-4-37"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-4-38" name="__codelineno-4-38" href="#__codelineno-4-38"></a>        <span class="k">if</span> <span class="n">success</span><span class="p">:</span>
<a id="__codelineno-4-39" name="__codelineno-4-39" href="#__codelineno-4-39"></a>            <span class="n">delta</span> <span class="o">=</span> <span class="n">learning_rate</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">**</span> <span class="bp">self</span><span class="o">.</span><span class="n">gain_sensitivity</span><span class="p">)</span>
<a id="__codelineno-4-40" name="__codelineno-4-40" href="#__codelineno-4-40"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-4-41" name="__codelineno-4-41" href="#__codelineno-4-41"></a>            <span class="n">delta</span> <span class="o">=</span> <span class="o">-</span><span class="n">learning_rate</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss_aversion</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">**</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss_sensitivity</span><span class="p">)</span>
<a id="__codelineno-4-42" name="__codelineno-4-42" href="#__codelineno-4-42"></a>        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">current_weight</span> <span class="o">+</span> <span class="n">delta</span><span class="p">))</span>
</code></pre></div>
<p><strong>Integration Point</strong>: Replace the symmetric EMA in
<code>corteX/engine/weights.py</code> <code>ToolPreferenceWeights.record_use()</code> and
<code>ModelSelectionWeights.update()</code>. The reference point should be the running
average success rate (adapts over time).</p>
<h3 id="13-anchoring-bias-initial-weights-shape-future-behavior">1.3 Anchoring Bias: Initial Weights Shape Future Behavior<a class="headerlink" href="#13-anchoring-bias-initial-weights-shape-future-behavior" title="Permanent link">&para;</a></h3>
<p><strong>Theoretical Background</strong></p>
<p>Anchoring (Tversky &amp; Kahneman, 1974) occurs when an initial piece of
information disproportionately influences subsequent judgments. Even when the
anchor is arbitrary, subsequent estimates are biased toward it.</p>
<p><strong>Application to corteX</strong></p>
<p>In the current system, <code>ToolPreferenceWeights</code> initializes all tools with
<code>success_rate: 0.5</code>, <code>preference_score: 0.5</code>. This 0.5 anchor means:</p>
<ul>
<li><strong>Harmful anchoring</strong>: A genuinely bad tool starts at 0.5 and takes multiple
  failures to drop, causing wasted execution in the meantime.</li>
<li><strong>Beneficial anchoring</strong>: A tool with known historical performance should be
  anchored to its historical rate, not 0.5.</li>
</ul>
<p><strong>Concrete SDK Pattern: Informed Anchor Initialization</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">AnchorManager</span><span class="p">:</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="sd">    Manages initial weight anchors using historical priors.</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="sd">    Prevents arbitrary 0.5 initialization from dominating early behavior.</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_historical_anchors</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_anchor_confidence</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">set_anchor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">confidence</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Set an informed anchor based on historical data or global weights.&quot;&quot;&quot;</span>
<a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_historical_anchors</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
<a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_anchor_confidence</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">confidence</span>
<a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a>
<a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_initial_weight</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a><span class="sd">        Get initial weight and confidence for a new entity.</span>
<a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a><span class="sd">        Returns (weight, confidence). Higher confidence = stronger anchor.</span>
<a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-5-21" name="__codelineno-5-21" href="#__codelineno-5-21"></a>        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_historical_anchors</span><span class="p">:</span>
<a id="__codelineno-5-22" name="__codelineno-5-22" href="#__codelineno-5-22"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_historical_anchors</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_anchor_confidence</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
<a id="__codelineno-5-23" name="__codelineno-5-23" href="#__codelineno-5-23"></a>        <span class="c1"># Uninformed prior: 0.5 with low confidence (easy to update)</span>
<a id="__codelineno-5-24" name="__codelineno-5-24" href="#__codelineno-5-24"></a>        <span class="k">return</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.1</span>
<a id="__codelineno-5-25" name="__codelineno-5-25" href="#__codelineno-5-25"></a>
<a id="__codelineno-5-26" name="__codelineno-5-26" href="#__codelineno-5-26"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">debiasing_rate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">confidence</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-5-27" name="__codelineno-5-27" href="#__codelineno-5-27"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-5-28" name="__codelineno-5-28" href="#__codelineno-5-28"></a><span class="sd">        Higher confidence anchors require more evidence to move.</span>
<a id="__codelineno-5-29" name="__codelineno-5-29" href="#__codelineno-5-29"></a><span class="sd">        Low confidence anchors are easy to update (good for exploration).</span>
<a id="__codelineno-5-30" name="__codelineno-5-30" href="#__codelineno-5-30"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-5-31" name="__codelineno-5-31" href="#__codelineno-5-31"></a>        <span class="c1"># Learning rate inversely proportional to anchor confidence</span>
<a id="__codelineno-5-32" name="__codelineno-5-32" href="#__codelineno-5-32"></a>        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.15</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">confidence</span><span class="p">))</span>
</code></pre></div>
<p><strong>Integration Point</strong>: <code>corteX/engine/weights.py</code>
<code>ToolPreferenceWeights.register_tool()</code> -- replace hardcoded 0.5 initialization.
Feed from <code>GlobalWeights</code> or episodic memory for informed anchors.</p>
<h3 id="14-availability-heuristic-recency-bias-in-memory">1.4 Availability Heuristic: Recency Bias in Memory<a class="headerlink" href="#14-availability-heuristic-recency-bias-in-memory" title="Permanent link">&para;</a></h3>
<p><strong>Theoretical Background</strong></p>
<p>The availability heuristic (Tversky &amp; Kahneman, 1973) causes people to
overweight recent, vivid, or emotionally salient events when making judgments.
A tool that failed spectacularly yesterday looms larger than one that succeeded
quietly a hundred times.</p>
<p><strong>Application to corteX</strong></p>
<p>The current EMA in <code>ToolPreferenceWeights</code> already has recency bias built in
(recent events have higher weight). However, this is uncontrolled -- we should
be deliberate about when recency bias helps and when it hurts.</p>
<p><strong>When Recency Bias Helps</strong>:
- Detecting real changes in tool reliability (a tool's API went down recently)
- Adapting to shifting user preferences within a session
- Reacting to environmental changes (new model version deployed)</p>
<p><strong>When Recency Bias Hurts</strong>:
- Overreacting to a single anomalous failure
- Ignoring long-term reliable performance due to one bad result
- Catastrophizing a single slow response</p>
<p><strong>Concrete SDK Pattern: Controlled Availability</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">AvailabilityFilter</span><span class="p">:</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="sd">    Controls recency bias in weight updates.</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="sd">    Uses a two-window approach: short-term (recent) and long-term (stable).</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="sd">    Detects when recent events genuinely differ from baseline vs. noise.</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">short_window</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">long_window</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50</span><span class="p">):</span>
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">short_window</span> <span class="o">=</span> <span class="n">short_window</span>
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">long_window</span> <span class="o">=</span> <span class="n">long_window</span>
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]]]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a>
<a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">success</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a>        <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">:</span>
<a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">timestamp</span><span class="p">,</span> <span class="n">success</span><span class="p">))</span>
<a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a>        <span class="c1"># Trim to long window</span>
<a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">[</span><span class="n">key</span><span class="p">])</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">long_window</span> <span class="o">*</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">long_window</span> <span class="o">*</span> <span class="mi">2</span><span class="p">:]</span>
<a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a>
<a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_adjusted_rate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]:</span>
<a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-6-23" name="__codelineno-6-23" href="#__codelineno-6-23"></a><span class="sd">        Returns (adjusted_success_rate, is_anomalous).</span>
<a id="__codelineno-6-24" name="__codelineno-6-24" href="#__codelineno-6-24"></a><span class="sd">        If short-term rate significantly differs from long-term,</span>
<a id="__codelineno-6-25" name="__codelineno-6-25" href="#__codelineno-6-25"></a><span class="sd">        flags it as anomalous (might be real change or noise).</span>
<a id="__codelineno-6-26" name="__codelineno-6-26" href="#__codelineno-6-26"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-6-27" name="__codelineno-6-27" href="#__codelineno-6-27"></a>        <span class="n">events</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">[])</span>
<a id="__codelineno-6-28" name="__codelineno-6-28" href="#__codelineno-6-28"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">events</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">short_window</span><span class="p">:</span>
<a id="__codelineno-6-29" name="__codelineno-6-29" href="#__codelineno-6-29"></a>            <span class="k">return</span> <span class="mf">0.5</span><span class="p">,</span> <span class="kc">False</span>
<a id="__codelineno-6-30" name="__codelineno-6-30" href="#__codelineno-6-30"></a>
<a id="__codelineno-6-31" name="__codelineno-6-31" href="#__codelineno-6-31"></a>        <span class="n">recent</span> <span class="o">=</span> <span class="n">events</span><span class="p">[</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">short_window</span><span class="p">:]</span>
<a id="__codelineno-6-32" name="__codelineno-6-32" href="#__codelineno-6-32"></a>        <span class="n">historical</span> <span class="o">=</span> <span class="n">events</span><span class="p">[</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">long_window</span><span class="p">:]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">events</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">long_window</span> <span class="k">else</span> <span class="n">events</span>
<a id="__codelineno-6-33" name="__codelineno-6-33" href="#__codelineno-6-33"></a>
<a id="__codelineno-6-34" name="__codelineno-6-34" href="#__codelineno-6-34"></a>        <span class="n">recent_rate</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">recent</span> <span class="k">if</span> <span class="n">s</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">recent</span><span class="p">)</span>
<a id="__codelineno-6-35" name="__codelineno-6-35" href="#__codelineno-6-35"></a>        <span class="n">historical_rate</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">historical</span> <span class="k">if</span> <span class="n">s</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">historical</span><span class="p">)</span>
<a id="__codelineno-6-36" name="__codelineno-6-36" href="#__codelineno-6-36"></a>
<a id="__codelineno-6-37" name="__codelineno-6-37" href="#__codelineno-6-37"></a>        <span class="n">deviation</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">recent_rate</span> <span class="o">-</span> <span class="n">historical_rate</span><span class="p">)</span>
<a id="__codelineno-6-38" name="__codelineno-6-38" href="#__codelineno-6-38"></a>        <span class="n">is_anomalous</span> <span class="o">=</span> <span class="n">deviation</span> <span class="o">&gt;</span> <span class="mf">0.3</span>  <span class="c1"># Significant deviation</span>
<a id="__codelineno-6-39" name="__codelineno-6-39" href="#__codelineno-6-39"></a>
<a id="__codelineno-6-40" name="__codelineno-6-40" href="#__codelineno-6-40"></a>        <span class="k">if</span> <span class="n">is_anomalous</span><span class="p">:</span>
<a id="__codelineno-6-41" name="__codelineno-6-41" href="#__codelineno-6-41"></a>            <span class="c1"># Blend: trust recent more when deviation is real</span>
<a id="__codelineno-6-42" name="__codelineno-6-42" href="#__codelineno-6-42"></a>            <span class="n">adjusted</span> <span class="o">=</span> <span class="mf">0.7</span> <span class="o">*</span> <span class="n">recent_rate</span> <span class="o">+</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">historical_rate</span>
<a id="__codelineno-6-43" name="__codelineno-6-43" href="#__codelineno-6-43"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-6-44" name="__codelineno-6-44" href="#__codelineno-6-44"></a>            <span class="c1"># Stable: trust long-term more</span>
<a id="__codelineno-6-45" name="__codelineno-6-45" href="#__codelineno-6-45"></a>            <span class="n">adjusted</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">recent_rate</span> <span class="o">+</span> <span class="mf">0.7</span> <span class="o">*</span> <span class="n">historical_rate</span>
<a id="__codelineno-6-46" name="__codelineno-6-46" href="#__codelineno-6-46"></a>
<a id="__codelineno-6-47" name="__codelineno-6-47" href="#__codelineno-6-47"></a>        <span class="k">return</span> <span class="n">adjusted</span><span class="p">,</span> <span class="n">is_anomalous</span>
</code></pre></div>
<p><strong>Integration Point</strong>: <code>corteX/engine/weights.py</code>
<code>ToolPreferenceWeights.record_use()</code> -- wrap the EMA update with availability
filtering. Also integrates with <code>corteX/engine/adaptation.py</code>
<code>SustainedAdaptation</code> for detecting genuine behavioral shifts.</p>
<h3 id="15-framing-effects-how-context-shapes-decisions">1.5 Framing Effects: How Context Shapes Decisions<a class="headerlink" href="#15-framing-effects-how-context-shapes-decisions" title="Permanent link">&para;</a></h3>
<p><strong>Theoretical Background</strong></p>
<p>Framing effects (Tversky &amp; Kahneman, 1981) demonstrate that the same
information presented differently leads to different decisions. "90% success
rate" feels different from "10% failure rate" even though they are identical.</p>
<p><strong>Application to corteX</strong></p>
<p>When the agent presents options to a user or makes internal decisions, framing
matters:</p>
<ul>
<li><strong>Internal framing</strong>: How tool scores are compared. A tool with score 0.7 out
  of 1.0 looks different when framed as "30% below maximum" vs. "40% above
  minimum."</li>
<li><strong>Relative framing</strong>: Tool A (0.75) vs. Tool B (0.70) looks like a close
  race. But framed as "Tool A is 7% better than Tool B," it becomes decisive.</li>
<li><strong>Loss framing</strong>: "This tool has failed 3 of last 10 times" is more
  impactful than "this tool succeeded 7 of last 10 times."</li>
</ul>
<p><strong>Concrete SDK Pattern: <code>FrameNormalizer</code></strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">FrameNormalizer</span><span class="p">:</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="sd">    Normalizes decision framing to prevent framing-induced biases.</span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="sd">    Presents all comparisons in a consistent frame.</span>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">normalize_scores</span><span class="p">(</span><span class="n">scores</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a><span class="sd">        Normalize scores to relative frame.</span>
<a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a><span class="sd">        Prevents the anchoring effect of absolute scores.</span>
<a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">scores</span><span class="p">:</span>
<a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a>            <span class="k">return</span> <span class="p">{}</span>
<a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a>        <span class="n">min_s</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">scores</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a>        <span class="n">max_s</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">scores</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a>        <span class="n">range_s</span> <span class="o">=</span> <span class="n">max_s</span> <span class="o">-</span> <span class="n">min_s</span>
<a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a>        <span class="k">if</span> <span class="n">range_s</span> <span class="o">&lt;</span> <span class="mf">0.01</span><span class="p">:</span>
<a id="__codelineno-7-19" name="__codelineno-7-19" href="#__codelineno-7-19"></a>            <span class="k">return</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="mf">0.5</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">scores</span><span class="p">}</span>
<a id="__codelineno-7-20" name="__codelineno-7-20" href="#__codelineno-7-20"></a>        <span class="k">return</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="p">(</span><span class="n">v</span> <span class="o">-</span> <span class="n">min_s</span><span class="p">)</span> <span class="o">/</span> <span class="n">range_s</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">scores</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
<a id="__codelineno-7-21" name="__codelineno-7-21" href="#__codelineno-7-21"></a>
<a id="__codelineno-7-22" name="__codelineno-7-22" href="#__codelineno-7-22"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-7-23" name="__codelineno-7-23" href="#__codelineno-7-23"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">loss_frame_penalty</span><span class="p">(</span><span class="n">success_rate</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-7-24" name="__codelineno-7-24" href="#__codelineno-7-24"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-7-25" name="__codelineno-7-25" href="#__codelineno-7-25"></a><span class="sd">        Apply loss-framing: present failure rate perspective.</span>
<a id="__codelineno-7-26" name="__codelineno-7-26" href="#__codelineno-7-26"></a><span class="sd">        A 0.9 success rate = 0.1 failure rate.</span>
<a id="__codelineno-7-27" name="__codelineno-7-27" href="#__codelineno-7-27"></a><span class="sd">        With loss aversion (2.25x), the perceived quality drops.</span>
<a id="__codelineno-7-28" name="__codelineno-7-28" href="#__codelineno-7-28"></a><span class="sd">        Perceived quality = success_rate - 2.25 * failure_rate (normalized)</span>
<a id="__codelineno-7-29" name="__codelineno-7-29" href="#__codelineno-7-29"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-7-30" name="__codelineno-7-30" href="#__codelineno-7-30"></a>        <span class="n">failure_rate</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">success_rate</span>
<a id="__codelineno-7-31" name="__codelineno-7-31" href="#__codelineno-7-31"></a>        <span class="n">perceived</span> <span class="o">=</span> <span class="n">success_rate</span> <span class="o">-</span> <span class="mf">2.25</span> <span class="o">*</span> <span class="n">failure_rate</span>
<a id="__codelineno-7-32" name="__codelineno-7-32" href="#__codelineno-7-32"></a>        <span class="c1"># Normalize back to 0-1 range</span>
<a id="__codelineno-7-33" name="__codelineno-7-33" href="#__codelineno-7-33"></a>        <span class="c1"># At success_rate=1.0: perceived = 1.0</span>
<a id="__codelineno-7-34" name="__codelineno-7-34" href="#__codelineno-7-34"></a>        <span class="c1"># At success_rate=0.5: perceived = 0.5 - 2.25*0.5 = -0.625</span>
<a id="__codelineno-7-35" name="__codelineno-7-35" href="#__codelineno-7-35"></a>        <span class="c1"># Normalize: (perceived + 2.25) / (1 + 2.25) = (perceived + 2.25) / 3.25</span>
<a id="__codelineno-7-36" name="__codelineno-7-36" href="#__codelineno-7-36"></a>        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="p">(</span><span class="n">perceived</span> <span class="o">+</span> <span class="mf">2.25</span><span class="p">)</span> <span class="o">/</span> <span class="mf">3.25</span><span class="p">))</span>
</code></pre></div>
<p><strong>Integration Point</strong>: <code>corteX/engine/population.py</code>
<code>PopulationToolSelector.select()</code> -- normalize scores before comparison.
Also useful in <code>corteX/core/llm/router.py</code> <code>LLMRouter._select_model()</code>.</p>
<hr />
<h2 id="part-ii-game-theory-for-multi-agent-decision-making">Part II: Game Theory for Multi-Agent Decision Making<a class="headerlink" href="#part-ii-game-theory-for-multi-agent-decision-making" title="Permanent link">&para;</a></h2>
<h3 id="21-nash-equilibrium-stable-toolmodel-selection-strategies">2.1 Nash Equilibrium: Stable Tool/Model Selection Strategies<a class="headerlink" href="#21-nash-equilibrium-stable-toolmodel-selection-strategies" title="Permanent link">&para;</a></h3>
<p><strong>Theoretical Background</strong></p>
<p>A Nash Equilibrium is a state where no player can improve their outcome by
unilaterally changing their strategy. In a multi-agent system, this represents a
stable configuration where each component's strategy is optimal given what the
others are doing.</p>
<p>For corteX, the "players" are:
- Available LLM models (competing for task assignment)
- Available tools (competing for execution)
- Task types (competing for compute budget)</p>
<p><strong>Application to corteX</strong></p>
<p>When multiple models are available for a task type, the system should converge
to a stable routing strategy (Nash Equilibrium) where:
- Each model handles the task types it is best at
- No model would benefit from being assigned to a different task type
- The overall system performance is locally optimal</p>
<p><strong>Mathematical Formulation</strong></p>
<p>For models M = {m1, m2, ..., mn} and task types T = {t1, t2, ..., tk}:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>Strategy profile: sigma = (sigma_1, ..., sigma_n) where sigma_i: T -&gt; [0,1]
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>                  sigma_i(t) = probability model i is assigned task type t
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>Nash Equilibrium: For all i, for all sigma_i&#39;:
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>  U_i(sigma_i, sigma_{-i}) &gt;= U_i(sigma_i&#39;, sigma_{-i})
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>Where U_i = sum_t sigma_i(t) * quality(i,t) * (1/latency(i,t)) - cost(i,t)
</code></pre></div>
<p><strong>Concrete SDK Pattern: <code>NashRoutingOptimizer</code></strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">NashRoutingOptimizer</span><span class="p">:</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="sd">    Finds stable routing strategies using iterative best-response dynamics.</span>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="sd">    Converges toward Nash Equilibrium for model-task assignment.</span>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">models</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">task_types</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
<a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">models</span> <span class="o">=</span> <span class="n">models</span>
<a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">task_types</span> <span class="o">=</span> <span class="n">task_types</span>
<a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a>        <span class="c1"># Strategy: model -&gt; task_type -&gt; assignment probability</span>
<a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a>        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">models</span><span class="p">)</span>
<a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a>        <span class="n">k</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">task_types</span><span class="p">)</span>
<a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a>        <span class="c1"># Initialize uniform</span>
<a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">strategy</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a>            <span class="n">m</span><span class="p">:</span> <span class="p">{</span><span class="n">t</span><span class="p">:</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">k</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">task_types</span><span class="p">}</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">models</span>
<a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a>        <span class="p">}</span>
<a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">utilities</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-9-18" name="__codelineno-9-18" href="#__codelineno-9-18"></a>            <span class="n">m</span><span class="p">:</span> <span class="p">{</span><span class="n">t</span><span class="p">:</span> <span class="mf">0.5</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">task_types</span><span class="p">}</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">models</span>
<a id="__codelineno-9-19" name="__codelineno-9-19" href="#__codelineno-9-19"></a>        <span class="p">}</span>
<a id="__codelineno-9-20" name="__codelineno-9-20" href="#__codelineno-9-20"></a>
<a id="__codelineno-9-21" name="__codelineno-9-21" href="#__codelineno-9-21"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update_utility</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">task_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">quality</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-9-22" name="__codelineno-9-22" href="#__codelineno-9-22"></a>                       <span class="n">latency_ms</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">cost</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-9-23" name="__codelineno-9-23" href="#__codelineno-9-23"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Record observed utility for a model-task combination.&quot;&quot;&quot;</span>
<a id="__codelineno-9-24" name="__codelineno-9-24" href="#__codelineno-9-24"></a>        <span class="c1"># Utility = quality-weighted speed minus cost</span>
<a id="__codelineno-9-25" name="__codelineno-9-25" href="#__codelineno-9-25"></a>        <span class="n">speed_factor</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="nb">max</span><span class="p">(</span><span class="n">latency_ms</span> <span class="o">/</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<a id="__codelineno-9-26" name="__codelineno-9-26" href="#__codelineno-9-26"></a>        <span class="n">utility</span> <span class="o">=</span> <span class="n">quality</span> <span class="o">*</span> <span class="n">speed_factor</span> <span class="o">-</span> <span class="n">cost</span>
<a id="__codelineno-9-27" name="__codelineno-9-27" href="#__codelineno-9-27"></a>        <span class="c1"># EMA update</span>
<a id="__codelineno-9-28" name="__codelineno-9-28" href="#__codelineno-9-28"></a>        <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.1</span>
<a id="__codelineno-9-29" name="__codelineno-9-29" href="#__codelineno-9-29"></a>        <span class="n">old</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">utilities</span><span class="p">[</span><span class="n">model</span><span class="p">][</span><span class="n">task_type</span><span class="p">]</span>
<a id="__codelineno-9-30" name="__codelineno-9-30" href="#__codelineno-9-30"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">utilities</span><span class="p">[</span><span class="n">model</span><span class="p">][</span><span class="n">task_type</span><span class="p">]</span> <span class="o">=</span> <span class="n">old</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">)</span> <span class="o">+</span> <span class="n">utility</span> <span class="o">*</span> <span class="n">alpha</span>
<a id="__codelineno-9-31" name="__codelineno-9-31" href="#__codelineno-9-31"></a>
<a id="__codelineno-9-32" name="__codelineno-9-32" href="#__codelineno-9-32"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">best_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<a id="__codelineno-9-33" name="__codelineno-9-33" href="#__codelineno-9-33"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-9-34" name="__codelineno-9-34" href="#__codelineno-9-34"></a><span class="sd">        Compute the best response strategy for a model given others&#39; strategies.</span>
<a id="__codelineno-9-35" name="__codelineno-9-35" href="#__codelineno-9-35"></a><span class="sd">        Assigns higher probability to task types where this model has</span>
<a id="__codelineno-9-36" name="__codelineno-9-36" href="#__codelineno-9-36"></a><span class="sd">        comparative advantage.</span>
<a id="__codelineno-9-37" name="__codelineno-9-37" href="#__codelineno-9-37"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-9-38" name="__codelineno-9-38" href="#__codelineno-9-38"></a>        <span class="n">utils</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">utilities</span><span class="p">[</span><span class="n">model</span><span class="p">]</span>
<a id="__codelineno-9-39" name="__codelineno-9-39" href="#__codelineno-9-39"></a>        <span class="n">total</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">utils</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<a id="__codelineno-9-40" name="__codelineno-9-40" href="#__codelineno-9-40"></a>        <span class="k">if</span> <span class="n">total</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-9-41" name="__codelineno-9-41" href="#__codelineno-9-41"></a>            <span class="k">return</span> <span class="p">{</span><span class="n">t</span><span class="p">:</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">task_types</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">task_types</span><span class="p">}</span>
<a id="__codelineno-9-42" name="__codelineno-9-42" href="#__codelineno-9-42"></a>        <span class="k">return</span> <span class="p">{</span><span class="n">t</span><span class="p">:</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span> <span class="o">/</span> <span class="n">total</span> <span class="k">for</span> <span class="n">t</span><span class="p">,</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">utils</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
<a id="__codelineno-9-43" name="__codelineno-9-43" href="#__codelineno-9-43"></a>
<a id="__codelineno-9-44" name="__codelineno-9-44" href="#__codelineno-9-44"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">iterate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">steps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-9-45" name="__codelineno-9-45" href="#__codelineno-9-45"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Run iterated best-response to approach Nash Equilibrium.&quot;&quot;&quot;</span>
<a id="__codelineno-9-46" name="__codelineno-9-46" href="#__codelineno-9-46"></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
<a id="__codelineno-9-47" name="__codelineno-9-47" href="#__codelineno-9-47"></a>            <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">:</span>
<a id="__codelineno-9-48" name="__codelineno-9-48" href="#__codelineno-9-48"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">strategy</span><span class="p">[</span><span class="n">model</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">best_response</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<a id="__codelineno-9-49" name="__codelineno-9-49" href="#__codelineno-9-49"></a>
<a id="__codelineno-9-50" name="__codelineno-9-50" href="#__codelineno-9-50"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_assignment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]:</span>
<a id="__codelineno-9-51" name="__codelineno-9-51" href="#__codelineno-9-51"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get ranked models for a task type with assignment probabilities.&quot;&quot;&quot;</span>
<a id="__codelineno-9-52" name="__codelineno-9-52" href="#__codelineno-9-52"></a>        <span class="n">scored</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-9-53" name="__codelineno-9-53" href="#__codelineno-9-53"></a>        <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">models</span><span class="p">:</span>
<a id="__codelineno-9-54" name="__codelineno-9-54" href="#__codelineno-9-54"></a>            <span class="n">prob</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">strategy</span><span class="p">[</span><span class="n">model</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">task_type</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-9-55" name="__codelineno-9-55" href="#__codelineno-9-55"></a>            <span class="n">utility</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">utilities</span><span class="p">[</span><span class="n">model</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">task_type</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-9-56" name="__codelineno-9-56" href="#__codelineno-9-56"></a>            <span class="n">scored</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">model</span><span class="p">,</span> <span class="n">prob</span> <span class="o">*</span> <span class="n">utility</span><span class="p">))</span>
<a id="__codelineno-9-57" name="__codelineno-9-57" href="#__codelineno-9-57"></a>        <span class="n">scored</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-9-58" name="__codelineno-9-58" href="#__codelineno-9-58"></a>        <span class="k">return</span> <span class="n">scored</span>
</code></pre></div>
<p><strong>Integration Point</strong>: <code>corteX/core/llm/router.py</code> <code>LLMRouter._select_model()</code>.
Run <code>iterate()</code> periodically (e.g., at session end during consolidation) to
update routing strategies.</p>
<h3 id="22-minimax-risk-minimization-for-high-stakes-decisions">2.2 Minimax: Risk Minimization for High-Stakes Decisions<a class="headerlink" href="#22-minimax-risk-minimization-for-high-stakes-decisions" title="Permanent link">&para;</a></h3>
<p><strong>Theoretical Background</strong></p>
<p>The minimax principle (von Neumann, 1928) seeks to minimize the maximum
possible loss. In decision theory under uncertainty, the minimax strategy
assumes an adversarial environment and prepares for the worst case.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>Minimax strategy: argmin_a max_s Loss(a, s)
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>Where:
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>  a = action (tool/model choice)
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>  s = possible state of the world (failure modes)
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>  Loss(a, s) = cost if action a is taken and state s occurs
</code></pre></div>
<p><strong>Application to corteX Enterprise Decisions</strong></p>
<p>For high-stakes enterprise tasks (data_sensitivity &gt; 0.8, compliance_rules
present), the agent should use minimax thinking:</p>
<ul>
<li>What is the worst thing that could happen if I use this tool?</li>
<li>What is the maximum damage of a wrong model output?</li>
<li>Which choice minimizes the worst-case scenario?</li>
</ul>
<p><strong>Concrete SDK Pattern: <code>MinimaxSafetyGuard</code></strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">MinimaxSafetyGuard</span><span class="p">:</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="sd">    Applies minimax reasoning for high-stakes enterprise decisions.</span>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="sd">    Selects actions that minimize worst-case loss.</span>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">risk_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">):</span>
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">risk_threshold</span> <span class="o">=</span> <span class="n">risk_threshold</span>
<a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a>        <span class="c1"># Worst-case loss estimates per tool/action</span>
<a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_worst_case_losses</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a>
<a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">register_worst_case</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">max_loss</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Register the worst-case loss for an action.&quot;&quot;&quot;</span>
<a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_worst_case_losses</span><span class="p">[</span><span class="n">action</span><span class="p">]</span> <span class="o">=</span> <span class="n">max_loss</span>
<a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a>
<a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">minimax_select</span><span class="p">(</span>
<a id="__codelineno-11-17" name="__codelineno-11-17" href="#__codelineno-11-17"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-11-18" name="__codelineno-11-18" href="#__codelineno-11-18"></a>        <span class="n">candidates</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<a id="__codelineno-11-19" name="__codelineno-11-19" href="#__codelineno-11-19"></a>        <span class="n">expected_gains</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
<a id="__codelineno-11-20" name="__codelineno-11-20" href="#__codelineno-11-20"></a>        <span class="n">enterprise_safety</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-11-21" name="__codelineno-11-21" href="#__codelineno-11-21"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-11-22" name="__codelineno-11-22" href="#__codelineno-11-22"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-11-23" name="__codelineno-11-23" href="#__codelineno-11-23"></a><span class="sd">        Select action using minimax when stakes are high.</span>
<a id="__codelineno-11-24" name="__codelineno-11-24" href="#__codelineno-11-24"></a><span class="sd">        Falls back to expected-value maximization when stakes are low.</span>
<a id="__codelineno-11-25" name="__codelineno-11-25" href="#__codelineno-11-25"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-11-26" name="__codelineno-11-26" href="#__codelineno-11-26"></a>        <span class="k">if</span> <span class="n">enterprise_safety</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">risk_threshold</span><span class="p">:</span>
<a id="__codelineno-11-27" name="__codelineno-11-27" href="#__codelineno-11-27"></a>            <span class="c1"># Low stakes: maximize expected gain (normal behavior)</span>
<a id="__codelineno-11-28" name="__codelineno-11-28" href="#__codelineno-11-28"></a>            <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">candidates</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">expected_gains</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<a id="__codelineno-11-29" name="__codelineno-11-29" href="#__codelineno-11-29"></a>
<a id="__codelineno-11-30" name="__codelineno-11-30" href="#__codelineno-11-30"></a>        <span class="c1"># High stakes: minimize worst-case loss</span>
<a id="__codelineno-11-31" name="__codelineno-11-31" href="#__codelineno-11-31"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">minimax_score</span><span class="p">(</span><span class="n">action</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-11-32" name="__codelineno-11-32" href="#__codelineno-11-32"></a>            <span class="n">worst_loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_worst_case_losses</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<a id="__codelineno-11-33" name="__codelineno-11-33" href="#__codelineno-11-33"></a>            <span class="n">expected_gain</span> <span class="o">=</span> <span class="n">expected_gains</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
<a id="__codelineno-11-34" name="__codelineno-11-34" href="#__codelineno-11-34"></a>            <span class="c1"># Blend: mostly minimize loss, some weight on gain</span>
<a id="__codelineno-11-35" name="__codelineno-11-35" href="#__codelineno-11-35"></a>            <span class="k">return</span> <span class="o">-</span><span class="n">worst_loss</span> <span class="o">*</span> <span class="mf">0.8</span> <span class="o">+</span> <span class="n">expected_gain</span> <span class="o">*</span> <span class="mf">0.2</span>
<a id="__codelineno-11-36" name="__codelineno-11-36" href="#__codelineno-11-36"></a>
<a id="__codelineno-11-37" name="__codelineno-11-37" href="#__codelineno-11-37"></a>        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">candidates</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">minimax_score</span><span class="p">)</span>
</code></pre></div>
<p><strong>Integration Point</strong>: <code>corteX/runtime/orchestrator.py</code> -- wrap tool selection
with minimax guard when <code>enterprise.get("data_sensitivity") &gt; threshold</code>. Also
integrates with <code>corteX/plugins/agents/supervisor.py</code> for policy enforcement.</p>
<h3 id="23-mechanism-design-truthful-capability-reporting">2.3 Mechanism Design: Truthful Capability Reporting<a class="headerlink" href="#23-mechanism-design-truthful-capability-reporting" title="Permanent link">&para;</a></h3>
<p><strong>Theoretical Background</strong></p>
<p>Mechanism design (Myerson, Maskin -- Nobel Prize 2007) is "reverse game theory":
designing the rules of the game so that strategic agents truthfully reveal
information. The Vickrey-Clarke-Groves (VCG) mechanism ensures truthful
reporting is the dominant strategy.</p>
<p><strong>Application to corteX</strong></p>
<p>Tools and models in corteX self-report capabilities (speed tier, supported
tasks). But what if a tool "lies" (due to misconfiguration or optimistic
metadata)? The scoring system should incentivize truthful self-reporting.</p>
<p><strong>Concrete SDK Pattern: Incentive-Compatible Scoring</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">TruthfulScoringMechanism</span><span class="p">:</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="sd">    Designs scoring incentives so that tools benefit from honest</span>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="sd">    capability reporting.</span>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="sd">    VCG-inspired: A tool&#39;s score is based on the marginal contribution</span>
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="sd">    it makes to overall system performance, not self-reported capabilities.</span>
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a>
<a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_declared_capabilities</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_observed_performance</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a>
<a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">declare</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">capabilities</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Tool declares its capabilities.&quot;&quot;&quot;</span>
<a id="__codelineno-12-16" name="__codelineno-12-16" href="#__codelineno-12-16"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_declared_capabilities</span><span class="p">[</span><span class="n">tool</span><span class="p">]</span> <span class="o">=</span> <span class="n">capabilities</span>
<a id="__codelineno-12-17" name="__codelineno-12-17" href="#__codelineno-12-17"></a>
<a id="__codelineno-12-18" name="__codelineno-12-18" href="#__codelineno-12-18"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">observe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">actual_performance</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-12-19" name="__codelineno-12-19" href="#__codelineno-12-19"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Record actual observed performance.&quot;&quot;&quot;</span>
<a id="__codelineno-12-20" name="__codelineno-12-20" href="#__codelineno-12-20"></a>        <span class="k">if</span> <span class="n">tool</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_observed_performance</span><span class="p">:</span>
<a id="__codelineno-12-21" name="__codelineno-12-21" href="#__codelineno-12-21"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_observed_performance</span><span class="p">[</span><span class="n">tool</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-12-22" name="__codelineno-12-22" href="#__codelineno-12-22"></a>        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">actual_performance</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-12-23" name="__codelineno-12-23" href="#__codelineno-12-23"></a>            <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.15</span>
<a id="__codelineno-12-24" name="__codelineno-12-24" href="#__codelineno-12-24"></a>            <span class="n">old</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_observed_performance</span><span class="p">[</span><span class="n">tool</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
<a id="__codelineno-12-25" name="__codelineno-12-25" href="#__codelineno-12-25"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_observed_performance</span><span class="p">[</span><span class="n">tool</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">old</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">)</span> <span class="o">+</span> <span class="n">v</span> <span class="o">*</span> <span class="n">alpha</span>
<a id="__codelineno-12-26" name="__codelineno-12-26" href="#__codelineno-12-26"></a>
<a id="__codelineno-12-27" name="__codelineno-12-27" href="#__codelineno-12-27"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">credibility_score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-12-28" name="__codelineno-12-28" href="#__codelineno-12-28"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-12-29" name="__codelineno-12-29" href="#__codelineno-12-29"></a><span class="sd">        How well do declared capabilities match observed performance?</span>
<a id="__codelineno-12-30" name="__codelineno-12-30" href="#__codelineno-12-30"></a><span class="sd">        High credibility = tool reports honestly.</span>
<a id="__codelineno-12-31" name="__codelineno-12-31" href="#__codelineno-12-31"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-12-32" name="__codelineno-12-32" href="#__codelineno-12-32"></a>        <span class="n">declared</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_declared_capabilities</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">tool</span><span class="p">,</span> <span class="p">{})</span>
<a id="__codelineno-12-33" name="__codelineno-12-33" href="#__codelineno-12-33"></a>        <span class="n">observed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_observed_performance</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">tool</span><span class="p">,</span> <span class="p">{})</span>
<a id="__codelineno-12-34" name="__codelineno-12-34" href="#__codelineno-12-34"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">declared</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">observed</span><span class="p">:</span>
<a id="__codelineno-12-35" name="__codelineno-12-35" href="#__codelineno-12-35"></a>            <span class="k">return</span> <span class="mf">0.5</span>
<a id="__codelineno-12-36" name="__codelineno-12-36" href="#__codelineno-12-36"></a>
<a id="__codelineno-12-37" name="__codelineno-12-37" href="#__codelineno-12-37"></a>        <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-12-38" name="__codelineno-12-38" href="#__codelineno-12-38"></a>        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">declared</span><span class="p">:</span>
<a id="__codelineno-12-39" name="__codelineno-12-39" href="#__codelineno-12-39"></a>            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">observed</span><span class="p">:</span>
<a id="__codelineno-12-40" name="__codelineno-12-40" href="#__codelineno-12-40"></a>                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">declared</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">-</span> <span class="n">observed</span><span class="p">[</span><span class="n">key</span><span class="p">]))</span>
<a id="__codelineno-12-41" name="__codelineno-12-41" href="#__codelineno-12-41"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">errors</span><span class="p">:</span>
<a id="__codelineno-12-42" name="__codelineno-12-42" href="#__codelineno-12-42"></a>            <span class="k">return</span> <span class="mf">0.5</span>
<a id="__codelineno-12-43" name="__codelineno-12-43" href="#__codelineno-12-43"></a>
<a id="__codelineno-12-44" name="__codelineno-12-44" href="#__codelineno-12-44"></a>        <span class="n">avg_error</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span>
<a id="__codelineno-12-45" name="__codelineno-12-45" href="#__codelineno-12-45"></a>        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">avg_error</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-12-46" name="__codelineno-12-46" href="#__codelineno-12-46"></a>
<a id="__codelineno-12-47" name="__codelineno-12-47" href="#__codelineno-12-47"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">adjusted_score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">raw_score</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-12-48" name="__codelineno-12-48" href="#__codelineno-12-48"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-12-49" name="__codelineno-12-49" href="#__codelineno-12-49"></a><span class="sd">        Adjust a tool&#39;s score by its credibility.</span>
<a id="__codelineno-12-50" name="__codelineno-12-50" href="#__codelineno-12-50"></a><span class="sd">        Honest tools get their full score. Dishonest tools are penalized.</span>
<a id="__codelineno-12-51" name="__codelineno-12-51" href="#__codelineno-12-51"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-12-52" name="__codelineno-12-52" href="#__codelineno-12-52"></a>        <span class="n">credibility</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">credibility_score</span><span class="p">(</span><span class="n">tool</span><span class="p">)</span>
<a id="__codelineno-12-53" name="__codelineno-12-53" href="#__codelineno-12-53"></a>        <span class="k">return</span> <span class="n">raw_score</span> <span class="o">*</span> <span class="n">credibility</span>
</code></pre></div>
<p><strong>Integration Point</strong>: <code>corteX/engine/weights.py</code>
<code>ToolPreferenceWeights.get_preference()</code> -- multiply by credibility score.
Feed declarations from tool registration in <code>corteX/tools/executor.py</code>.</p>
<h3 id="24-cooperative-game-theory-shapley-values-for-attribution">2.4 Cooperative Game Theory: Shapley Values for Attribution<a class="headerlink" href="#24-cooperative-game-theory-shapley-values-for-attribution" title="Permanent link">&para;</a></h3>
<p><strong>Theoretical Background</strong></p>
<p>Shapley values (Shapley, 1953) provide a mathematically fair way to distribute
credit among cooperating players. For a coalitional game with N players:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>phi_i(v) = sum_{S subset N, i not in S}
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>    [|S|! * (|N|-|S|-1)! / |N|!] * [v(S union {i}) - v(S)]
</code></pre></div>
<p>Where:
- <code>phi_i(v)</code> = player i's Shapley value (fair contribution)
- <code>v(S)</code> = value generated by coalition S
- The sum is over all possible coalitions not containing i</p>
<p>Properties (uniquely characterized):
- <strong>Efficiency</strong>: Contributions sum to total value
- <strong>Symmetry</strong>: Equal players get equal credit
- <strong>Additivity</strong>: Contributions across games add up
- <strong>Dummy player</strong>: Non-contributors get zero</p>
<p><strong>Application to corteX</strong></p>
<p>When multiple tools and models collaborate on a task, Shapley values determine
how much credit each component deserves for the final outcome.</p>
<p><strong>Concrete SDK Pattern: <code>ShapleyAttributor</code></strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">itertools</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="k">class</span><span class="w"> </span><span class="nc">ShapleyAttributor</span><span class="p">:</span>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="sd">    Computes Shapley values for multi-tool/model task attribution.</span>
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="sd">    Answers: &quot;How much did each component contribute to the outcome?&quot;</span>
<a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a>
<a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_coalition_values</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a>
<a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">record_coalition_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">players</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">value</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-14-14" name="__codelineno-14-14" href="#__codelineno-14-14"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Record the outcome value for a coalition of tools/models.&quot;&quot;&quot;</span>
<a id="__codelineno-14-15" name="__codelineno-14-15" href="#__codelineno-14-15"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_coalition_values</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">(</span><span class="n">players</span><span class="p">)]</span> <span class="o">=</span> <span class="n">value</span>
<a id="__codelineno-14-16" name="__codelineno-14-16" href="#__codelineno-14-16"></a>
<a id="__codelineno-14-17" name="__codelineno-14-17" href="#__codelineno-14-17"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">compute_shapley</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">all_players</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<a id="__codelineno-14-18" name="__codelineno-14-18" href="#__codelineno-14-18"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-14-19" name="__codelineno-14-19" href="#__codelineno-14-19"></a><span class="sd">        Compute Shapley values for each player.</span>
<a id="__codelineno-14-20" name="__codelineno-14-20" href="#__codelineno-14-20"></a><span class="sd">        For N players, this requires evaluating 2^N coalitions.</span>
<a id="__codelineno-14-21" name="__codelineno-14-21" href="#__codelineno-14-21"></a><span class="sd">        For small N (typical: 2-6 tools + 1-2 models), this is tractable.</span>
<a id="__codelineno-14-22" name="__codelineno-14-22" href="#__codelineno-14-22"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-14-23" name="__codelineno-14-23" href="#__codelineno-14-23"></a>        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_players</span><span class="p">)</span>
<a id="__codelineno-14-24" name="__codelineno-14-24" href="#__codelineno-14-24"></a>        <span class="n">players_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">all_players</span><span class="p">)</span>
<a id="__codelineno-14-25" name="__codelineno-14-25" href="#__codelineno-14-25"></a>        <span class="n">shapley_values</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">p</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">all_players</span><span class="p">}</span>
<a id="__codelineno-14-26" name="__codelineno-14-26" href="#__codelineno-14-26"></a>
<a id="__codelineno-14-27" name="__codelineno-14-27" href="#__codelineno-14-27"></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">player</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">players_list</span><span class="p">):</span>
<a id="__codelineno-14-28" name="__codelineno-14-28" href="#__codelineno-14-28"></a>            <span class="n">others</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">players_list</span> <span class="k">if</span> <span class="n">p</span> <span class="o">!=</span> <span class="n">player</span><span class="p">]</span>
<a id="__codelineno-14-29" name="__codelineno-14-29" href="#__codelineno-14-29"></a>            <span class="k">for</span> <span class="n">size</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">others</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
<a id="__codelineno-14-30" name="__codelineno-14-30" href="#__codelineno-14-30"></a>                <span class="k">for</span> <span class="n">coalition</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="n">others</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
<a id="__codelineno-14-31" name="__codelineno-14-31" href="#__codelineno-14-31"></a>                    <span class="n">coalition_set</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">coalition</span><span class="p">)</span>
<a id="__codelineno-14-32" name="__codelineno-14-32" href="#__codelineno-14-32"></a>                    <span class="n">coalition_with_player</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">coalition</span><span class="p">)</span> <span class="o">|</span> <span class="p">{</span><span class="n">player</span><span class="p">}</span>
<a id="__codelineno-14-33" name="__codelineno-14-33" href="#__codelineno-14-33"></a>                    <span class="n">v_with</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_coalition_values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">coalition_with_player</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
<a id="__codelineno-14-34" name="__codelineno-14-34" href="#__codelineno-14-34"></a>                    <span class="n">v_without</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_coalition_values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">coalition_set</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
<a id="__codelineno-14-35" name="__codelineno-14-35" href="#__codelineno-14-35"></a>                    <span class="n">marginal</span> <span class="o">=</span> <span class="n">v_with</span> <span class="o">-</span> <span class="n">v_without</span>
<a id="__codelineno-14-36" name="__codelineno-14-36" href="#__codelineno-14-36"></a>                    <span class="c1"># Shapley weight</span>
<a id="__codelineno-14-37" name="__codelineno-14-37" href="#__codelineno-14-37"></a>                    <span class="n">weight</span> <span class="o">=</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">size</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-14-38" name="__codelineno-14-38" href="#__codelineno-14-38"></a>                              <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
<a id="__codelineno-14-39" name="__codelineno-14-39" href="#__codelineno-14-39"></a>                    <span class="n">shapley_values</span><span class="p">[</span><span class="n">player</span><span class="p">]</span> <span class="o">+=</span> <span class="n">weight</span> <span class="o">*</span> <span class="n">marginal</span>
<a id="__codelineno-14-40" name="__codelineno-14-40" href="#__codelineno-14-40"></a>
<a id="__codelineno-14-41" name="__codelineno-14-41" href="#__codelineno-14-41"></a>        <span class="k">return</span> <span class="n">shapley_values</span>
<a id="__codelineno-14-42" name="__codelineno-14-42" href="#__codelineno-14-42"></a>
<a id="__codelineno-14-43" name="__codelineno-14-43" href="#__codelineno-14-43"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">approximate_shapley</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">all_players</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<a id="__codelineno-14-44" name="__codelineno-14-44" href="#__codelineno-14-44"></a>                            <span class="n">num_permutations</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<a id="__codelineno-14-45" name="__codelineno-14-45" href="#__codelineno-14-45"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-14-46" name="__codelineno-14-46" href="#__codelineno-14-46"></a><span class="sd">        Monte Carlo approximation for larger player sets.</span>
<a id="__codelineno-14-47" name="__codelineno-14-47" href="#__codelineno-14-47"></a><span class="sd">        Sample random permutations and average marginal contributions.</span>
<a id="__codelineno-14-48" name="__codelineno-14-48" href="#__codelineno-14-48"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-14-49" name="__codelineno-14-49" href="#__codelineno-14-49"></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<a id="__codelineno-14-50" name="__codelineno-14-50" href="#__codelineno-14-50"></a>        <span class="n">players_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">all_players</span><span class="p">)</span>
<a id="__codelineno-14-51" name="__codelineno-14-51" href="#__codelineno-14-51"></a>        <span class="n">shapley_values</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">p</span><span class="p">:</span> <span class="mf">0.0</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">all_players</span><span class="p">}</span>
<a id="__codelineno-14-52" name="__codelineno-14-52" href="#__codelineno-14-52"></a>
<a id="__codelineno-14-53" name="__codelineno-14-53" href="#__codelineno-14-53"></a>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_permutations</span><span class="p">):</span>
<a id="__codelineno-14-54" name="__codelineno-14-54" href="#__codelineno-14-54"></a>            <span class="n">perm</span> <span class="o">=</span> <span class="n">players_list</span><span class="p">[:]</span>
<a id="__codelineno-14-55" name="__codelineno-14-55" href="#__codelineno-14-55"></a>            <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">perm</span><span class="p">)</span>
<a id="__codelineno-14-56" name="__codelineno-14-56" href="#__codelineno-14-56"></a>            <span class="n">coalition</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<a id="__codelineno-14-57" name="__codelineno-14-57" href="#__codelineno-14-57"></a>            <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="n">perm</span><span class="p">:</span>
<a id="__codelineno-14-58" name="__codelineno-14-58" href="#__codelineno-14-58"></a>                <span class="n">v_with</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_coalition_values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
<a id="__codelineno-14-59" name="__codelineno-14-59" href="#__codelineno-14-59"></a>                    <span class="nb">frozenset</span><span class="p">(</span><span class="n">coalition</span> <span class="o">|</span> <span class="p">{</span><span class="n">player</span><span class="p">}),</span> <span class="mf">0.0</span><span class="p">)</span>
<a id="__codelineno-14-60" name="__codelineno-14-60" href="#__codelineno-14-60"></a>                <span class="n">v_without</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_coalition_values</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
<a id="__codelineno-14-61" name="__codelineno-14-61" href="#__codelineno-14-61"></a>                    <span class="nb">frozenset</span><span class="p">(</span><span class="n">coalition</span><span class="p">),</span> <span class="mf">0.0</span><span class="p">)</span>
<a id="__codelineno-14-62" name="__codelineno-14-62" href="#__codelineno-14-62"></a>                <span class="n">shapley_values</span><span class="p">[</span><span class="n">player</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">v_with</span> <span class="o">-</span> <span class="n">v_without</span><span class="p">)</span>
<a id="__codelineno-14-63" name="__codelineno-14-63" href="#__codelineno-14-63"></a>                <span class="n">coalition</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">player</span><span class="p">)</span>
<a id="__codelineno-14-64" name="__codelineno-14-64" href="#__codelineno-14-64"></a>
<a id="__codelineno-14-65" name="__codelineno-14-65" href="#__codelineno-14-65"></a>        <span class="c1"># Average</span>
<a id="__codelineno-14-66" name="__codelineno-14-66" href="#__codelineno-14-66"></a>        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">shapley_values</span><span class="p">:</span>
<a id="__codelineno-14-67" name="__codelineno-14-67" href="#__codelineno-14-67"></a>            <span class="n">shapley_values</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">/=</span> <span class="n">num_permutations</span>
<a id="__codelineno-14-68" name="__codelineno-14-68" href="#__codelineno-14-68"></a>
<a id="__codelineno-14-69" name="__codelineno-14-69" href="#__codelineno-14-69"></a>        <span class="k">return</span> <span class="n">shapley_values</span>
</code></pre></div>
<p><strong>Integration Point</strong>: <code>corteX/engine/plasticity.py</code> <code>HebbianRule.apply()</code> --
instead of equal credit, distribute using Shapley values. Also feeds into
<code>corteX/engine/weights.py</code> for multi-tool weight updates.</p>
<h3 id="25-repeated-games-learning-tool-reliability-over-time">2.5 Repeated Games: Learning Tool Reliability Over Time<a class="headerlink" href="#25-repeated-games-learning-tool-reliability-over-time" title="Permanent link">&para;</a></h3>
<p><strong>Theoretical Background</strong></p>
<p>In the iterated Prisoner's Dilemma (Axelrod, 1984), cooperation strategies like
Tit-for-Tat emerge when games are repeated. Key insights:</p>
<ul>
<li><strong>Reputation matters</strong>: Past behavior predicts future behavior.</li>
<li><strong>Forgiveness helps</strong>: Occasional failures should not permanently destroy trust.</li>
<li><strong>Reciprocity</strong>: Tools that consistently deliver get more opportunities.</li>
<li><strong>Grim trigger</strong>: A threshold below which trust is permanently lost (but can
  be recovered through sustained good behavior).</li>
</ul>
<p><strong>Application to corteX</strong></p>
<p>The relationship between corteX and each tool is an iterated game. Each
invocation is one "round." The trust dynamics should follow:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>Trust evolution:
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>  trust(t+1) = trust(t) + alpha * (outcome - trust(t))     # Basic EMA
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>Tit-for-Tat variant:
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>  trust(t+1) = trust(t) + alpha * (outcome - trust(t))
<a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a>               + beta * (consistency - 0.5)                  # Consistency bonus
<a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a>               - gamma * (recent_failures &gt; threshold)        # Grim trigger
</code></pre></div>
<p>Where <code>consistency</code> measures how predictable the tool's performance is (low
variance = high consistency), and the grim trigger activates quarantine for
unreliable tools.</p>
<p><strong>Concrete SDK Pattern: <code>ReputationSystem</code></strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">ReputationSystem</span><span class="p">:</span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="sd">    Tracks tool/model reputation over iterated interactions.</span>
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="sd">    Implements modified Tit-for-Tat with forgiveness and grim trigger.</span>
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>
<a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_trust</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_consistency</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_history</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">bool</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_quarantined</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># tool -&gt; quarantine_until</span>
<a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a>
<a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">success</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Record interaction outcome and return updated trust.&quot;&quot;&quot;</span>
<a id="__codelineno-16-15" name="__codelineno-16-15" href="#__codelineno-16-15"></a>        <span class="k">if</span> <span class="n">tool</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trust</span><span class="p">:</span>
<a id="__codelineno-16-16" name="__codelineno-16-16" href="#__codelineno-16-16"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_trust</span><span class="p">[</span><span class="n">tool</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>
<a id="__codelineno-16-17" name="__codelineno-16-17" href="#__codelineno-16-17"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_history</span><span class="p">[</span><span class="n">tool</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-16-18" name="__codelineno-16-18" href="#__codelineno-16-18"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_consistency</span><span class="p">[</span><span class="n">tool</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>
<a id="__codelineno-16-19" name="__codelineno-16-19" href="#__codelineno-16-19"></a>
<a id="__codelineno-16-20" name="__codelineno-16-20" href="#__codelineno-16-20"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_history</span><span class="p">[</span><span class="n">tool</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">success</span><span class="p">)</span>
<a id="__codelineno-16-21" name="__codelineno-16-21" href="#__codelineno-16-21"></a>
<a id="__codelineno-16-22" name="__codelineno-16-22" href="#__codelineno-16-22"></a>        <span class="c1"># Trust update (EMA)</span>
<a id="__codelineno-16-23" name="__codelineno-16-23" href="#__codelineno-16-23"></a>        <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.1</span>
<a id="__codelineno-16-24" name="__codelineno-16-24" href="#__codelineno-16-24"></a>        <span class="n">outcome</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="k">if</span> <span class="n">success</span> <span class="k">else</span> <span class="mf">0.0</span>
<a id="__codelineno-16-25" name="__codelineno-16-25" href="#__codelineno-16-25"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_trust</span><span class="p">[</span><span class="n">tool</span><span class="p">]</span> <span class="o">+=</span> <span class="n">alpha</span> <span class="o">*</span> <span class="p">(</span><span class="n">outcome</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trust</span><span class="p">[</span><span class="n">tool</span><span class="p">])</span>
<a id="__codelineno-16-26" name="__codelineno-16-26" href="#__codelineno-16-26"></a>
<a id="__codelineno-16-27" name="__codelineno-16-27" href="#__codelineno-16-27"></a>        <span class="c1"># Consistency update (inverse variance of recent outcomes)</span>
<a id="__codelineno-16-28" name="__codelineno-16-28" href="#__codelineno-16-28"></a>        <span class="n">recent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_history</span><span class="p">[</span><span class="n">tool</span><span class="p">][</span><span class="o">-</span><span class="mi">20</span><span class="p">:]</span>
<a id="__codelineno-16-29" name="__codelineno-16-29" href="#__codelineno-16-29"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">recent</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
<a id="__codelineno-16-30" name="__codelineno-16-30" href="#__codelineno-16-30"></a>            <span class="n">mean</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">recent</span> <span class="k">if</span> <span class="n">s</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">recent</span><span class="p">)</span>
<a id="__codelineno-16-31" name="__codelineno-16-31" href="#__codelineno-16-31"></a>            <span class="n">variance</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">((</span><span class="mf">1.0</span> <span class="k">if</span> <span class="n">s</span> <span class="k">else</span> <span class="mf">0.0</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
<a id="__codelineno-16-32" name="__codelineno-16-32" href="#__codelineno-16-32"></a>                          <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">recent</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">recent</span><span class="p">)</span>
<a id="__codelineno-16-33" name="__codelineno-16-33" href="#__codelineno-16-33"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_consistency</span><span class="p">[</span><span class="n">tool</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">variance</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span>
<a id="__codelineno-16-34" name="__codelineno-16-34" href="#__codelineno-16-34"></a>
<a id="__codelineno-16-35" name="__codelineno-16-35" href="#__codelineno-16-35"></a>        <span class="c1"># Grim trigger: quarantine after N consecutive failures</span>
<a id="__codelineno-16-36" name="__codelineno-16-36" href="#__codelineno-16-36"></a>        <span class="n">consecutive_failures</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-16-37" name="__codelineno-16-37" href="#__codelineno-16-37"></a>        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_history</span><span class="p">[</span><span class="n">tool</span><span class="p">]):</span>
<a id="__codelineno-16-38" name="__codelineno-16-38" href="#__codelineno-16-38"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">s</span><span class="p">:</span>
<a id="__codelineno-16-39" name="__codelineno-16-39" href="#__codelineno-16-39"></a>                <span class="n">consecutive_failures</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-16-40" name="__codelineno-16-40" href="#__codelineno-16-40"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-16-41" name="__codelineno-16-41" href="#__codelineno-16-41"></a>                <span class="k">break</span>
<a id="__codelineno-16-42" name="__codelineno-16-42" href="#__codelineno-16-42"></a>        <span class="k">if</span> <span class="n">consecutive_failures</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>
<a id="__codelineno-16-43" name="__codelineno-16-43" href="#__codelineno-16-43"></a>            <span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<a id="__codelineno-16-44" name="__codelineno-16-44" href="#__codelineno-16-44"></a>            <span class="n">quarantine_duration</span> <span class="o">=</span> <span class="mi">60</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">consecutive_failures</span><span class="p">)</span>
<a id="__codelineno-16-45" name="__codelineno-16-45" href="#__codelineno-16-45"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_quarantined</span><span class="p">[</span><span class="n">tool</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">+</span> <span class="n">quarantine_duration</span>
<a id="__codelineno-16-46" name="__codelineno-16-46" href="#__codelineno-16-46"></a>
<a id="__codelineno-16-47" name="__codelineno-16-47" href="#__codelineno-16-47"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trust</span><span class="p">[</span><span class="n">tool</span><span class="p">]</span>
<a id="__codelineno-16-48" name="__codelineno-16-48" href="#__codelineno-16-48"></a>
<a id="__codelineno-16-49" name="__codelineno-16-49" href="#__codelineno-16-49"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_trust</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-16-50" name="__codelineno-16-50" href="#__codelineno-16-50"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get current trust level (0.0 to 1.0).&quot;&quot;&quot;</span>
<a id="__codelineno-16-51" name="__codelineno-16-51" href="#__codelineno-16-51"></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<a id="__codelineno-16-52" name="__codelineno-16-52" href="#__codelineno-16-52"></a>        <span class="k">if</span> <span class="n">tool</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_quarantined</span><span class="p">:</span>
<a id="__codelineno-16-53" name="__codelineno-16-53" href="#__codelineno-16-53"></a>            <span class="k">if</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_quarantined</span><span class="p">[</span><span class="n">tool</span><span class="p">]:</span>
<a id="__codelineno-16-54" name="__codelineno-16-54" href="#__codelineno-16-54"></a>                <span class="k">return</span> <span class="mf">0.0</span>  <span class="c1"># Quarantined</span>
<a id="__codelineno-16-55" name="__codelineno-16-55" href="#__codelineno-16-55"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-16-56" name="__codelineno-16-56" href="#__codelineno-16-56"></a>                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_quarantined</span><span class="p">[</span><span class="n">tool</span><span class="p">]</span>
<a id="__codelineno-16-57" name="__codelineno-16-57" href="#__codelineno-16-57"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trust</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">tool</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<a id="__codelineno-16-58" name="__codelineno-16-58" href="#__codelineno-16-58"></a>
<a id="__codelineno-16-59" name="__codelineno-16-59" href="#__codelineno-16-59"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_quarantined</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-16-60" name="__codelineno-16-60" href="#__codelineno-16-60"></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<a id="__codelineno-16-61" name="__codelineno-16-61" href="#__codelineno-16-61"></a>        <span class="k">if</span> <span class="n">tool</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_quarantined</span><span class="p">:</span>
<a id="__codelineno-16-62" name="__codelineno-16-62" href="#__codelineno-16-62"></a>            <span class="k">if</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_quarantined</span><span class="p">[</span><span class="n">tool</span><span class="p">]:</span>
<a id="__codelineno-16-63" name="__codelineno-16-63" href="#__codelineno-16-63"></a>                <span class="k">return</span> <span class="kc">True</span>
<a id="__codelineno-16-64" name="__codelineno-16-64" href="#__codelineno-16-64"></a>            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_quarantined</span><span class="p">[</span><span class="n">tool</span><span class="p">]</span>
<a id="__codelineno-16-65" name="__codelineno-16-65" href="#__codelineno-16-65"></a>        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div>
<p><strong>Integration Point</strong>: <code>corteX/engine/weights.py</code>
<code>ToolPreferenceWeights.get_preference()</code> -- multiply by reputation trust score.
Also integrates with <code>corteX/engine/plasticity.py</code> <code>LTDRule</code> for the grim
trigger mechanism.</p>
<h3 id="26-bayesian-games-decisions-under-incomplete-information">2.6 Bayesian Games: Decisions Under Incomplete Information<a class="headerlink" href="#26-bayesian-games-decisions-under-incomplete-information" title="Permanent link">&para;</a></h3>
<p><strong>Theoretical Background</strong></p>
<p>In a Bayesian game (Harsanyi, 1967-68), players have incomplete information
about other players' types. Each player has a prior belief over others' types
and updates beliefs through observed actions.</p>
<p><strong>Application to corteX</strong></p>
<p>When a new tool is registered, corteX has incomplete information about its true
capabilities. The agent holds a prior belief (from declared capabilities or
global weights) and updates through observation:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>Type space: theta_i in Theta_i (tool i&#39;s true quality type)
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>Prior: p(theta_i) = initial belief about tool quality
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>Update: p(theta_i | observations) = posterior after seeing results
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>Strategy: sigma_i(theta_i) = how to use tool i given believed type
</code></pre></div>
<p><strong>Concrete SDK Pattern</strong>: This maps directly to the Bayesian updating framework
covered in Part III. The game-theoretic insight is that the agent should reason
about the <em>information structure</em>: which observations are most informative about
a tool's true type, and how to design experiments (exploration) that maximally
reduce uncertainty.</p>
<p><strong>Integration Point</strong>: Connects the Bayesian inference system (Part III) with
the game-theoretic framework. The exploration strategy in Thompson Sampling
(Section 3.2) is the optimal Bayesian game strategy.</p>
<hr />
<h2 id="part-iii-bayesian-mathematics-for-probabilistic-weight-updates">Part III: Bayesian Mathematics for Probabilistic Weight Updates<a class="headerlink" href="#part-iii-bayesian-mathematics-for-probabilistic-weight-updates" title="Permanent link">&para;</a></h2>
<h3 id="31-bayesian-updating-from-ema-to-proper-posterior-inference">3.1 Bayesian Updating: From EMA to Proper Posterior Inference<a class="headerlink" href="#31-bayesian-updating-from-ema-to-proper-posterior-inference" title="Permanent link">&para;</a></h3>
<p><strong>Theoretical Background</strong></p>
<p>Bayesian inference follows Bayes' rule:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>P(theta | data) = P(data | theta) * P(theta) / P(data)
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>  posterior     =   likelihood    *   prior   / evidence
</code></pre></div>
<p>The current EMA approach in corteX is a special case of Bayesian updating
with a specific implicit prior. But proper Bayesian updating offers:</p>
<ol>
<li><strong>Uncertainty quantification</strong>: Not just a point estimate, but a full
   distribution over possible values.</li>
<li><strong>Prior incorporation</strong>: Historical knowledge encoded as priors.</li>
<li><strong>Coherent updating</strong>: Each observation updates beliefs in a
   mathematically consistent way.</li>
<li><strong>Natural exploration</strong>: Uncertainty drives exploration (Thompson Sampling).</li>
</ol>
<p><strong>Current EMA vs. Bayesian Updating</strong></p>
<table>
<thead>
<tr>
<th>Feature</th>
<th>EMA (current)</th>
<th>Bayesian (proposed)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Output</td>
<td>Point estimate (single number)</td>
<td>Full distribution (mean + uncertainty)</td>
</tr>
<tr>
<td>Memory</td>
<td>Implicit (exponential decay)</td>
<td>Explicit (prior parameters)</td>
</tr>
<tr>
<td>Uncertainty</td>
<td>Not tracked</td>
<td>Natural byproduct</td>
</tr>
<tr>
<td>Exploration</td>
<td>Not addressed</td>
<td>Thompson Sampling</td>
</tr>
<tr>
<td>Prior knowledge</td>
<td>Hardcoded 0.5</td>
<td>Informed priors</td>
</tr>
<tr>
<td>Learning rate</td>
<td>Fixed alpha</td>
<td>Adaptive (shrinks with evidence)</td>
</tr>
</tbody>
</table>
<h3 id="32-thompson-sampling-exploration-vs-exploitation">3.2 Thompson Sampling: Exploration vs. Exploitation<a class="headerlink" href="#32-thompson-sampling-exploration-vs-exploitation" title="Permanent link">&para;</a></h3>
<p><strong>Theoretical Background</strong></p>
<p>Thompson Sampling (Thompson, 1933) is a Bayesian approach to the multi-armed
bandit problem that elegantly balances exploration and exploitation:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>Algorithm:
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>1. For each arm (tool/model), maintain a posterior distribution
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>   over its quality parameter.
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>2. Sample one value from each posterior.
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>3. Select the arm with the highest sampled value.
<a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>4. Observe the reward and update the posterior.
</code></pre></div>
<p>This naturally explores uncertain options (wide posteriors produce occasionally
high samples) while exploiting known good options (peaked posteriors produce
consistently high samples).</p>
<p><strong>Why Thompson Sampling for corteX</strong></p>
<p>The current <code>ToolPreferenceWeights.get_best_tool()</code> always selects the tool
with the highest point estimate. This is purely exploitative -- it never explores
alternatives that might be better but are uncertain. Thompson Sampling fixes this.</p>
<p><strong>Concrete SDK Pattern: <code>BayesianToolSelector</code></strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a>
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="k">class</span><span class="w"> </span><span class="nc">BetaDistribution</span><span class="p">:</span>
<a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="sd">    Beta distribution for binary outcomes (success/failure).</span>
<a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="sd">    Conjugate prior for Bernoulli likelihood.</span>
<a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="sd">    Beta(alpha, beta) where:</span>
<a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a><span class="sd">      alpha = 1 + number of successes</span>
<a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a><span class="sd">      beta = 1 + number of failures</span>
<a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a><span class="sd">      mean = alpha / (alpha + beta)</span>
<a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a><span class="sd">      variance = alpha * beta / ((alpha + beta)^2 * (alpha + beta + 1))</span>
<a id="__codelineno-20-13" name="__codelineno-20-13" href="#__codelineno-20-13"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-20-14" name="__codelineno-20-14" href="#__codelineno-20-14"></a>
<a id="__codelineno-20-15" name="__codelineno-20-15" href="#__codelineno-20-15"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">beta</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">):</span>
<a id="__codelineno-20-16" name="__codelineno-20-16" href="#__codelineno-20-16"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span>  <span class="c1"># pseudo-count of successes + 1</span>
<a id="__codelineno-20-17" name="__codelineno-20-17" href="#__codelineno-20-17"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">beta</span> <span class="o">=</span> <span class="n">beta</span>    <span class="c1"># pseudo-count of failures + 1</span>
<a id="__codelineno-20-18" name="__codelineno-20-18" href="#__codelineno-20-18"></a>
<a id="__codelineno-20-19" name="__codelineno-20-19" href="#__codelineno-20-19"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">success</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-20-20" name="__codelineno-20-20" href="#__codelineno-20-20"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Update posterior with new observation.&quot;&quot;&quot;</span>
<a id="__codelineno-20-21" name="__codelineno-20-21" href="#__codelineno-20-21"></a>        <span class="k">if</span> <span class="n">success</span><span class="p">:</span>
<a id="__codelineno-20-22" name="__codelineno-20-22" href="#__codelineno-20-22"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">+=</span> <span class="mf">1.0</span>
<a id="__codelineno-20-23" name="__codelineno-20-23" href="#__codelineno-20-23"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-20-24" name="__codelineno-20-24" href="#__codelineno-20-24"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">beta</span> <span class="o">+=</span> <span class="mf">1.0</span>
<a id="__codelineno-20-25" name="__codelineno-20-25" href="#__codelineno-20-25"></a>
<a id="__codelineno-20-26" name="__codelineno-20-26" href="#__codelineno-20-26"></a>    <span class="nd">@property</span>
<a id="__codelineno-20-27" name="__codelineno-20-27" href="#__codelineno-20-27"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-20-28" name="__codelineno-20-28" href="#__codelineno-20-28"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">)</span>
<a id="__codelineno-20-29" name="__codelineno-20-29" href="#__codelineno-20-29"></a>
<a id="__codelineno-20-30" name="__codelineno-20-30" href="#__codelineno-20-30"></a>    <span class="nd">@property</span>
<a id="__codelineno-20-31" name="__codelineno-20-31" href="#__codelineno-20-31"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">variance</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-20-32" name="__codelineno-20-32" href="#__codelineno-20-32"></a>        <span class="n">ab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span>
<a id="__codelineno-20-33" name="__codelineno-20-33" href="#__codelineno-20-33"></a>        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">ab</span> <span class="o">*</span> <span class="n">ab</span> <span class="o">*</span> <span class="p">(</span><span class="n">ab</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-20-34" name="__codelineno-20-34" href="#__codelineno-20-34"></a>
<a id="__codelineno-20-35" name="__codelineno-20-35" href="#__codelineno-20-35"></a>    <span class="nd">@property</span>
<a id="__codelineno-20-36" name="__codelineno-20-36" href="#__codelineno-20-36"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">std</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-20-37" name="__codelineno-20-37" href="#__codelineno-20-37"></a>        <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variance</span><span class="p">)</span>
<a id="__codelineno-20-38" name="__codelineno-20-38" href="#__codelineno-20-38"></a>
<a id="__codelineno-20-39" name="__codelineno-20-39" href="#__codelineno-20-39"></a>    <span class="nd">@property</span>
<a id="__codelineno-20-40" name="__codelineno-20-40" href="#__codelineno-20-40"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">confidence_interval_95</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<a id="__codelineno-20-41" name="__codelineno-20-41" href="#__codelineno-20-41"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Approximate 95% CI using normal approximation.&quot;&quot;&quot;</span>
<a id="__codelineno-20-42" name="__codelineno-20-42" href="#__codelineno-20-42"></a>        <span class="k">return</span> <span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">std</span><span class="p">),</span>
<a id="__codelineno-20-43" name="__codelineno-20-43" href="#__codelineno-20-43"></a>                <span class="nb">min</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">std</span><span class="p">))</span>
<a id="__codelineno-20-44" name="__codelineno-20-44" href="#__codelineno-20-44"></a>
<a id="__codelineno-20-45" name="__codelineno-20-45" href="#__codelineno-20-45"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-20-46" name="__codelineno-20-46" href="#__codelineno-20-46"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Draw a single sample from the Beta distribution.&quot;&quot;&quot;</span>
<a id="__codelineno-20-47" name="__codelineno-20-47" href="#__codelineno-20-47"></a>        <span class="c1"># Use the gamma function trick for Beta sampling</span>
<a id="__codelineno-20-48" name="__codelineno-20-48" href="#__codelineno-20-48"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">gammavariate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<a id="__codelineno-20-49" name="__codelineno-20-49" href="#__codelineno-20-49"></a>        <span class="n">y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">gammavariate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<a id="__codelineno-20-50" name="__codelineno-20-50" href="#__codelineno-20-50"></a>        <span class="k">return</span> <span class="n">x</span> <span class="o">/</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mf">0.5</span>
<a id="__codelineno-20-51" name="__codelineno-20-51" href="#__codelineno-20-51"></a>
<a id="__codelineno-20-52" name="__codelineno-20-52" href="#__codelineno-20-52"></a>    <span class="nd">@property</span>
<a id="__codelineno-20-53" name="__codelineno-20-53" href="#__codelineno-20-53"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">total_observations</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-20-54" name="__codelineno-20-54" href="#__codelineno-20-54"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span> <span class="o">-</span> <span class="mi">2</span>  <span class="c1"># Subtract initial pseudo-counts</span>
<a id="__codelineno-20-55" name="__codelineno-20-55" href="#__codelineno-20-55"></a>
<a id="__codelineno-20-56" name="__codelineno-20-56" href="#__codelineno-20-56"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<a id="__codelineno-20-57" name="__codelineno-20-57" href="#__codelineno-20-57"></a>        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;alpha&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">,</span> <span class="s2">&quot;beta&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">}</span>
<a id="__codelineno-20-58" name="__codelineno-20-58" href="#__codelineno-20-58"></a>
<a id="__codelineno-20-59" name="__codelineno-20-59" href="#__codelineno-20-59"></a>
<a id="__codelineno-20-60" name="__codelineno-20-60" href="#__codelineno-20-60"></a><span class="k">class</span><span class="w"> </span><span class="nc">BayesianToolSelector</span><span class="p">:</span>
<a id="__codelineno-20-61" name="__codelineno-20-61" href="#__codelineno-20-61"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-20-62" name="__codelineno-20-62" href="#__codelineno-20-62"></a><span class="sd">    Thompson Sampling for tool selection.</span>
<a id="__codelineno-20-63" name="__codelineno-20-63" href="#__codelineno-20-63"></a><span class="sd">    Maintains a Beta posterior for each tool&#39;s success probability.</span>
<a id="__codelineno-20-64" name="__codelineno-20-64" href="#__codelineno-20-64"></a><span class="sd">    Naturally balances exploration (uncertain tools) and exploitation (known good tools).</span>
<a id="__codelineno-20-65" name="__codelineno-20-65" href="#__codelineno-20-65"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-20-66" name="__codelineno-20-66" href="#__codelineno-20-66"></a>
<a id="__codelineno-20-67" name="__codelineno-20-67" href="#__codelineno-20-67"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-20-68" name="__codelineno-20-68" href="#__codelineno-20-68"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_posteriors</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">BetaDistribution</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-20-69" name="__codelineno-20-69" href="#__codelineno-20-69"></a>
<a id="__codelineno-20-70" name="__codelineno-20-70" href="#__codelineno-20-70"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">register_tool</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">prior_alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
<a id="__codelineno-20-71" name="__codelineno-20-71" href="#__codelineno-20-71"></a>                      <span class="n">prior_beta</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-20-72" name="__codelineno-20-72" href="#__codelineno-20-72"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Register a tool with optional informative prior.&quot;&quot;&quot;</span>
<a id="__codelineno-20-73" name="__codelineno-20-73" href="#__codelineno-20-73"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_posteriors</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">BetaDistribution</span><span class="p">(</span><span class="n">prior_alpha</span><span class="p">,</span> <span class="n">prior_beta</span><span class="p">)</span>
<a id="__codelineno-20-74" name="__codelineno-20-74" href="#__codelineno-20-74"></a>
<a id="__codelineno-20-75" name="__codelineno-20-75" href="#__codelineno-20-75"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">success</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-20-76" name="__codelineno-20-76" href="#__codelineno-20-76"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Update posterior after observing outcome.&quot;&quot;&quot;</span>
<a id="__codelineno-20-77" name="__codelineno-20-77" href="#__codelineno-20-77"></a>        <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_posteriors</span><span class="p">:</span>
<a id="__codelineno-20-78" name="__codelineno-20-78" href="#__codelineno-20-78"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">register_tool</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<a id="__codelineno-20-79" name="__codelineno-20-79" href="#__codelineno-20-79"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_posteriors</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">success</span><span class="p">)</span>
<a id="__codelineno-20-80" name="__codelineno-20-80" href="#__codelineno-20-80"></a>
<a id="__codelineno-20-81" name="__codelineno-20-81" href="#__codelineno-20-81"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">select</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">candidates</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-20-82" name="__codelineno-20-82" href="#__codelineno-20-82"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-20-83" name="__codelineno-20-83" href="#__codelineno-20-83"></a><span class="sd">        Thompson Sampling selection.</span>
<a id="__codelineno-20-84" name="__codelineno-20-84" href="#__codelineno-20-84"></a><span class="sd">        Sample from each candidate&#39;s posterior, pick the highest.</span>
<a id="__codelineno-20-85" name="__codelineno-20-85" href="#__codelineno-20-85"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-20-86" name="__codelineno-20-86" href="#__codelineno-20-86"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">candidates</span><span class="p">:</span>
<a id="__codelineno-20-87" name="__codelineno-20-87" href="#__codelineno-20-87"></a>            <span class="k">return</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-20-88" name="__codelineno-20-88" href="#__codelineno-20-88"></a>
<a id="__codelineno-20-89" name="__codelineno-20-89" href="#__codelineno-20-89"></a>        <span class="n">best_tool</span> <span class="o">=</span> <span class="n">candidates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-20-90" name="__codelineno-20-90" href="#__codelineno-20-90"></a>        <span class="n">best_sample</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>
<a id="__codelineno-20-91" name="__codelineno-20-91" href="#__codelineno-20-91"></a>
<a id="__codelineno-20-92" name="__codelineno-20-92" href="#__codelineno-20-92"></a>        <span class="k">for</span> <span class="n">tool</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
<a id="__codelineno-20-93" name="__codelineno-20-93" href="#__codelineno-20-93"></a>            <span class="k">if</span> <span class="n">tool</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_posteriors</span><span class="p">:</span>
<a id="__codelineno-20-94" name="__codelineno-20-94" href="#__codelineno-20-94"></a>                <span class="bp">self</span><span class="o">.</span><span class="n">register_tool</span><span class="p">(</span><span class="n">tool</span><span class="p">)</span>
<a id="__codelineno-20-95" name="__codelineno-20-95" href="#__codelineno-20-95"></a>            <span class="n">sample</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_posteriors</span><span class="p">[</span><span class="n">tool</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>
<a id="__codelineno-20-96" name="__codelineno-20-96" href="#__codelineno-20-96"></a>            <span class="k">if</span> <span class="n">sample</span> <span class="o">&gt;</span> <span class="n">best_sample</span><span class="p">:</span>
<a id="__codelineno-20-97" name="__codelineno-20-97" href="#__codelineno-20-97"></a>                <span class="n">best_sample</span> <span class="o">=</span> <span class="n">sample</span>
<a id="__codelineno-20-98" name="__codelineno-20-98" href="#__codelineno-20-98"></a>                <span class="n">best_tool</span> <span class="o">=</span> <span class="n">tool</span>
<a id="__codelineno-20-99" name="__codelineno-20-99" href="#__codelineno-20-99"></a>
<a id="__codelineno-20-100" name="__codelineno-20-100" href="#__codelineno-20-100"></a>        <span class="k">return</span> <span class="n">best_tool</span>
<a id="__codelineno-20-101" name="__codelineno-20-101" href="#__codelineno-20-101"></a>
<a id="__codelineno-20-102" name="__codelineno-20-102" href="#__codelineno-20-102"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_posterior_summary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<a id="__codelineno-20-103" name="__codelineno-20-103" href="#__codelineno-20-103"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get posterior summary for a tool.&quot;&quot;&quot;</span>
<a id="__codelineno-20-104" name="__codelineno-20-104" href="#__codelineno-20-104"></a>        <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_posteriors</span><span class="p">:</span>
<a id="__codelineno-20-105" name="__codelineno-20-105" href="#__codelineno-20-105"></a>            <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;mean&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">:</span> <span class="mf">0.29</span><span class="p">,</span> <span class="s2">&quot;observations&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
<a id="__codelineno-20-106" name="__codelineno-20-106" href="#__codelineno-20-106"></a>        <span class="n">post</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_posteriors</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
<a id="__codelineno-20-107" name="__codelineno-20-107" href="#__codelineno-20-107"></a>        <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-20-108" name="__codelineno-20-108" href="#__codelineno-20-108"></a>            <span class="s2">&quot;mean&quot;</span><span class="p">:</span> <span class="n">post</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span>
<a id="__codelineno-20-109" name="__codelineno-20-109" href="#__codelineno-20-109"></a>            <span class="s2">&quot;std&quot;</span><span class="p">:</span> <span class="n">post</span><span class="o">.</span><span class="n">std</span><span class="p">,</span>
<a id="__codelineno-20-110" name="__codelineno-20-110" href="#__codelineno-20-110"></a>            <span class="s2">&quot;ci_95&quot;</span><span class="p">:</span> <span class="n">post</span><span class="o">.</span><span class="n">confidence_interval_95</span><span class="p">,</span>
<a id="__codelineno-20-111" name="__codelineno-20-111" href="#__codelineno-20-111"></a>            <span class="s2">&quot;observations&quot;</span><span class="p">:</span> <span class="n">post</span><span class="o">.</span><span class="n">total_observations</span><span class="p">,</span>
<a id="__codelineno-20-112" name="__codelineno-20-112" href="#__codelineno-20-112"></a>            <span class="s2">&quot;alpha&quot;</span><span class="p">:</span> <span class="n">post</span><span class="o">.</span><span class="n">alpha</span><span class="p">,</span>
<a id="__codelineno-20-113" name="__codelineno-20-113" href="#__codelineno-20-113"></a>            <span class="s2">&quot;beta&quot;</span><span class="p">:</span> <span class="n">post</span><span class="o">.</span><span class="n">beta</span><span class="p">,</span>
<a id="__codelineno-20-114" name="__codelineno-20-114" href="#__codelineno-20-114"></a>        <span class="p">}</span>
<a id="__codelineno-20-115" name="__codelineno-20-115" href="#__codelineno-20-115"></a>
<a id="__codelineno-20-116" name="__codelineno-20-116" href="#__codelineno-20-116"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_all_summaries</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<a id="__codelineno-20-117" name="__codelineno-20-117" href="#__codelineno-20-117"></a>        <span class="k">return</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_posterior_summary</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<a id="__codelineno-20-118" name="__codelineno-20-118" href="#__codelineno-20-118"></a>                <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_posteriors</span><span class="p">}</span>
</code></pre></div>
<p><strong>Integration Point</strong>: Replace
<code>corteX/engine/weights.py</code> <code>ToolPreferenceWeights.get_best_tool()</code> with
Thompson Sampling selection. The <code>BetaDistribution</code> objects persist across
sessions alongside the weight file.</p>
<h3 id="33-bayesian-optimization-hyperparameter-tuning">3.3 Bayesian Optimization: Hyperparameter Tuning<a class="headerlink" href="#33-bayesian-optimization-hyperparameter-tuning" title="Permanent link">&para;</a></h3>
<p><strong>Theoretical Background</strong></p>
<p>Bayesian optimization uses a Gaussian Process (GP) surrogate model to
efficiently optimize expensive black-box functions. Key concepts:</p>
<ol>
<li><strong>Surrogate Model</strong>: GP that models the objective function.</li>
<li>Mean function: best estimate of objective value at any point</li>
<li>
<p>Variance function: uncertainty about the objective at that point</p>
</li>
<li>
<p><strong>Acquisition Function</strong>: Determines the next point to evaluate.</p>
</li>
<li><strong>Expected Improvement (EI)</strong>:
     <code>EI(x) = E[max(f(x) - f(x_best), 0)]</code></li>
<li><strong>Upper Confidence Bound (UCB)</strong>:
     <code>UCB(x) = mu(x) + kappa * sigma(x)</code></li>
<li><strong>Probability of Improvement (PI)</strong>:
     <code>PI(x) = P(f(x) &gt; f(x_best) + xi)</code></li>
</ol>
<p><strong>Application to corteX</strong></p>
<p>Hyperparameters that need tuning:
- Learning rates per weight category (currently hardcoded in <code>LearningRates</code>)
- Critical period length (currently <code>10</code> in <code>CriticalPeriodModulator</code>)
- Homeostatic regulation strength (currently <code>0.02</code>)
- EMA alpha values throughout the engine
- Outlier threshold in <code>PopulationDecoder</code> (currently <code>2.0</code>)
- Escalation thresholds for dual-process routing</p>
<p><strong>Concrete SDK Pattern: <code>BayesianHyperparameterTuner</code></strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">SimpleBayesianOptimizer</span><span class="p">:</span>
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="sd">    Lightweight Bayesian optimization for corteX hyperparameters.</span>
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="sd">    Uses a simplified surrogate model (no full GP dependency).</span>
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="sd">    Maintains observations and suggests next parameters to try.</span>
<a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a>
<a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param_bounds</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]):</span>
<a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">param_bounds</span> <span class="o">=</span> <span class="n">param_bounds</span>
<a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_observations</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_best_params</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_best_value</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;-inf&#39;</span><span class="p">)</span>
<a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a>
<a id="__codelineno-21-14" name="__codelineno-21-14" href="#__codelineno-21-14"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">suggest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_random</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<a id="__codelineno-21-15" name="__codelineno-21-15" href="#__codelineno-21-15"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-21-16" name="__codelineno-21-16" href="#__codelineno-21-16"></a><span class="sd">        Suggest next parameters to try.</span>
<a id="__codelineno-21-17" name="__codelineno-21-17" href="#__codelineno-21-17"></a><span class="sd">        Uses random search initially, then UCB-inspired suggestions.</span>
<a id="__codelineno-21-18" name="__codelineno-21-18" href="#__codelineno-21-18"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-21-19" name="__codelineno-21-19" href="#__codelineno-21-19"></a>        <span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<a id="__codelineno-21-20" name="__codelineno-21-20" href="#__codelineno-21-20"></a>
<a id="__codelineno-21-21" name="__codelineno-21-21" href="#__codelineno-21-21"></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_observations</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">n_random</span><span class="p">:</span>
<a id="__codelineno-21-22" name="__codelineno-21-22" href="#__codelineno-21-22"></a>            <span class="c1"># Random exploration phase</span>
<a id="__codelineno-21-23" name="__codelineno-21-23" href="#__codelineno-21-23"></a>            <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-21-24" name="__codelineno-21-24" href="#__codelineno-21-24"></a>                <span class="n">param</span><span class="p">:</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">)</span>
<a id="__codelineno-21-25" name="__codelineno-21-25" href="#__codelineno-21-25"></a>                <span class="k">for</span> <span class="n">param</span><span class="p">,</span> <span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_bounds</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<a id="__codelineno-21-26" name="__codelineno-21-26" href="#__codelineno-21-26"></a>            <span class="p">}</span>
<a id="__codelineno-21-27" name="__codelineno-21-27" href="#__codelineno-21-27"></a>
<a id="__codelineno-21-28" name="__codelineno-21-28" href="#__codelineno-21-28"></a>        <span class="c1"># UCB-inspired: perturb best known params with decreasing noise</span>
<a id="__codelineno-21-29" name="__codelineno-21-29" href="#__codelineno-21-29"></a>        <span class="n">noise_scale</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_observations</span><span class="p">))</span>
<a id="__codelineno-21-30" name="__codelineno-21-30" href="#__codelineno-21-30"></a>        <span class="n">suggestion</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-21-31" name="__codelineno-21-31" href="#__codelineno-21-31"></a>        <span class="k">for</span> <span class="n">param</span><span class="p">,</span> <span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="n">high</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_bounds</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-21-32" name="__codelineno-21-32" href="#__codelineno-21-32"></a>            <span class="n">best_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_best_params</span><span class="p">[</span><span class="n">param</span><span class="p">]</span>
<a id="__codelineno-21-33" name="__codelineno-21-33" href="#__codelineno-21-33"></a>            <span class="n">noise</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">gauss</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">high</span> <span class="o">-</span> <span class="n">low</span><span class="p">)</span> <span class="o">*</span> <span class="n">noise_scale</span><span class="p">)</span>
<a id="__codelineno-21-34" name="__codelineno-21-34" href="#__codelineno-21-34"></a>            <span class="n">suggestion</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">low</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">high</span><span class="p">,</span> <span class="n">best_val</span> <span class="o">+</span> <span class="n">noise</span><span class="p">))</span>
<a id="__codelineno-21-35" name="__codelineno-21-35" href="#__codelineno-21-35"></a>
<a id="__codelineno-21-36" name="__codelineno-21-36" href="#__codelineno-21-36"></a>        <span class="k">return</span> <span class="n">suggestion</span>
<a id="__codelineno-21-37" name="__codelineno-21-37" href="#__codelineno-21-37"></a>
<a id="__codelineno-21-38" name="__codelineno-21-38" href="#__codelineno-21-38"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span> <span class="n">objective_value</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-21-39" name="__codelineno-21-39" href="#__codelineno-21-39"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Record an observation (params -&gt; objective value).&quot;&quot;&quot;</span>
<a id="__codelineno-21-40" name="__codelineno-21-40" href="#__codelineno-21-40"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_observations</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">params</span><span class="p">,</span> <span class="n">objective_value</span><span class="p">))</span>
<a id="__codelineno-21-41" name="__codelineno-21-41" href="#__codelineno-21-41"></a>        <span class="k">if</span> <span class="n">objective_value</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_best_value</span><span class="p">:</span>
<a id="__codelineno-21-42" name="__codelineno-21-42" href="#__codelineno-21-42"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_best_value</span> <span class="o">=</span> <span class="n">objective_value</span>
<a id="__codelineno-21-43" name="__codelineno-21-43" href="#__codelineno-21-43"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_best_params</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<a id="__codelineno-21-44" name="__codelineno-21-44" href="#__codelineno-21-44"></a>
<a id="__codelineno-21-45" name="__codelineno-21-45" href="#__codelineno-21-45"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_best</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]],</span> <span class="nb">float</span><span class="p">]:</span>
<a id="__codelineno-21-46" name="__codelineno-21-46" href="#__codelineno-21-46"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get best parameters found so far.&quot;&quot;&quot;</span>
<a id="__codelineno-21-47" name="__codelineno-21-47" href="#__codelineno-21-47"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_best_params</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_best_value</span>
</code></pre></div>
<p><strong>Integration Point</strong>: New file <code>corteX/engine/tuning.py</code>. Runs during
<code>WeightEngine.consolidate()</code> to evaluate current hyperparameter performance
and suggest adjustments. Objective function = overall session success rate
or average quality score.</p>
<h3 id="34-conjugate-priors-the-right-distribution-for-each-data-type">3.4 Conjugate Priors: The Right Distribution for Each Data Type<a class="headerlink" href="#34-conjugate-priors-the-right-distribution-for-each-data-type" title="Permanent link">&para;</a></h3>
<p><strong>Theoretical Background</strong></p>
<p>A conjugate prior is a prior distribution that, when combined with a particular
likelihood function, produces a posterior in the same distribution family.
This enables closed-form Bayesian updates without numerical integration.</p>
<table>
<thead>
<tr>
<th>Data Type</th>
<th>Likelihood</th>
<th>Conjugate Prior</th>
<th>Posterior</th>
</tr>
</thead>
<tbody>
<tr>
<td>Binary success/failure</td>
<td>Bernoulli</td>
<td>Beta(a, b)</td>
<td>Beta(a + s, b + f)</td>
</tr>
<tr>
<td>Count data</td>
<td>Poisson</td>
<td>Gamma(a, b)</td>
<td>Gamma(a + sum, b + n)</td>
</tr>
<tr>
<td>Latency (positive reals)</td>
<td>Exponential</td>
<td>Gamma(a, b)</td>
<td>Gamma(a + n, b + sum)</td>
</tr>
<tr>
<td>Quality scores (real)</td>
<td>Normal(mu, sigma_known)</td>
<td>Normal(m0, s0)</td>
<td>Normal(m_n, s_n)</td>
</tr>
<tr>
<td>Categorical choices</td>
<td>Multinomial</td>
<td>Dirichlet(a1...ak)</td>
<td>Dirichlet(a1+c1...ak+ck)</td>
</tr>
</tbody>
</table>
<p><strong>Concrete SDK Patterns for corteX</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">GammaDistribution</span><span class="p">:</span>
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="sd">    Gamma distribution for latency modeling.</span>
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="sd">    Conjugate prior for Exponential likelihood.</span>
<a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a><span class="sd">    Gamma(shape, rate) where:</span>
<a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a><span class="sd">      mean = shape / rate</span>
<a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a><span class="sd">      variance = shape / rate^2</span>
<a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a>
<a id="__codelineno-22-10" name="__codelineno-22-10" href="#__codelineno-22-10"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shape</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.001</span><span class="p">):</span>
<a id="__codelineno-22-11" name="__codelineno-22-11" href="#__codelineno-22-11"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">shape</span>  <span class="c1"># alpha</span>
<a id="__codelineno-22-12" name="__codelineno-22-12" href="#__codelineno-22-12"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rate</span> <span class="o">=</span> <span class="n">rate</span>    <span class="c1"># beta</span>
<a id="__codelineno-22-13" name="__codelineno-22-13" href="#__codelineno-22-13"></a>
<a id="__codelineno-22-14" name="__codelineno-22-14" href="#__codelineno-22-14"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">observed_latency_ms</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-22-15" name="__codelineno-22-15" href="#__codelineno-22-15"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Update with an observed latency value.&quot;&quot;&quot;</span>
<a id="__codelineno-22-16" name="__codelineno-22-16" href="#__codelineno-22-16"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">shape</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-22-17" name="__codelineno-22-17" href="#__codelineno-22-17"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">rate</span> <span class="o">+=</span> <span class="n">observed_latency_ms</span>
<a id="__codelineno-22-18" name="__codelineno-22-18" href="#__codelineno-22-18"></a>
<a id="__codelineno-22-19" name="__codelineno-22-19" href="#__codelineno-22-19"></a>    <span class="nd">@property</span>
<a id="__codelineno-22-20" name="__codelineno-22-20" href="#__codelineno-22-20"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-22-21" name="__codelineno-22-21" href="#__codelineno-22-21"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Expected latency.&quot;&quot;&quot;</span>
<a id="__codelineno-22-22" name="__codelineno-22-22" href="#__codelineno-22-22"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">rate</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rate</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
<a id="__codelineno-22-23" name="__codelineno-22-23" href="#__codelineno-22-23"></a>
<a id="__codelineno-22-24" name="__codelineno-22-24" href="#__codelineno-22-24"></a>    <span class="nd">@property</span>
<a id="__codelineno-22-25" name="__codelineno-22-25" href="#__codelineno-22-25"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">variance</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-22-26" name="__codelineno-22-26" href="#__codelineno-22-26"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rate</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rate</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
<a id="__codelineno-22-27" name="__codelineno-22-27" href="#__codelineno-22-27"></a>
<a id="__codelineno-22-28" name="__codelineno-22-28" href="#__codelineno-22-28"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-22-29" name="__codelineno-22-29" href="#__codelineno-22-29"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Sample a latency value.&quot;&quot;&quot;</span>
<a id="__codelineno-22-30" name="__codelineno-22-30" href="#__codelineno-22-30"></a>        <span class="k">return</span> <span class="n">random</span><span class="o">.</span><span class="n">gammavariate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">rate</span><span class="p">)</span>
<a id="__codelineno-22-31" name="__codelineno-22-31" href="#__codelineno-22-31"></a>
<a id="__codelineno-22-32" name="__codelineno-22-32" href="#__codelineno-22-32"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">predictive_probability</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">latency_ms</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-22-33" name="__codelineno-22-33" href="#__codelineno-22-33"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;P(next latency = x | data) -- how surprising is this latency?&quot;&quot;&quot;</span>
<a id="__codelineno-22-34" name="__codelineno-22-34" href="#__codelineno-22-34"></a>        <span class="c1"># Posterior predictive is a Lomax (Pareto Type II) distribution</span>
<a id="__codelineno-22-35" name="__codelineno-22-35" href="#__codelineno-22-35"></a>        <span class="c1"># Using simplified approximation</span>
<a id="__codelineno-22-36" name="__codelineno-22-36" href="#__codelineno-22-36"></a>        <span class="n">expected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span>
<a id="__codelineno-22-37" name="__codelineno-22-37" href="#__codelineno-22-37"></a>        <span class="k">if</span> <span class="n">expected</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-22-38" name="__codelineno-22-38" href="#__codelineno-22-38"></a>            <span class="k">return</span> <span class="mf">0.5</span>
<a id="__codelineno-22-39" name="__codelineno-22-39" href="#__codelineno-22-39"></a>        <span class="n">ratio</span> <span class="o">=</span> <span class="n">latency_ms</span> <span class="o">/</span> <span class="n">expected</span>
<a id="__codelineno-22-40" name="__codelineno-22-40" href="#__codelineno-22-40"></a>        <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">ratio</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># Gaussian approx</span>
<a id="__codelineno-22-41" name="__codelineno-22-41" href="#__codelineno-22-41"></a>
<a id="__codelineno-22-42" name="__codelineno-22-42" href="#__codelineno-22-42"></a>
<a id="__codelineno-22-43" name="__codelineno-22-43" href="#__codelineno-22-43"></a><span class="k">class</span><span class="w"> </span><span class="nc">NormalNormalUpdater</span><span class="p">:</span>
<a id="__codelineno-22-44" name="__codelineno-22-44" href="#__codelineno-22-44"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-22-45" name="__codelineno-22-45" href="#__codelineno-22-45"></a><span class="sd">    Normal-Normal conjugate pair for quality score tracking.</span>
<a id="__codelineno-22-46" name="__codelineno-22-46" href="#__codelineno-22-46"></a><span class="sd">    Prior: Normal(mu_0, sigma_0^2)</span>
<a id="__codelineno-22-47" name="__codelineno-22-47" href="#__codelineno-22-47"></a><span class="sd">    Likelihood: Normal(mu, sigma_known^2)</span>
<a id="__codelineno-22-48" name="__codelineno-22-48" href="#__codelineno-22-48"></a><span class="sd">    Posterior: Normal(mu_n, sigma_n^2) with closed-form updates.</span>
<a id="__codelineno-22-49" name="__codelineno-22-49" href="#__codelineno-22-49"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-22-50" name="__codelineno-22-50" href="#__codelineno-22-50"></a>
<a id="__codelineno-22-51" name="__codelineno-22-51" href="#__codelineno-22-51"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prior_mean</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">prior_precision</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
<a id="__codelineno-22-52" name="__codelineno-22-52" href="#__codelineno-22-52"></a>                 <span class="n">known_noise_precision</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">4.0</span><span class="p">):</span>
<a id="__codelineno-22-53" name="__codelineno-22-53" href="#__codelineno-22-53"></a>        <span class="c1"># Precision = 1/variance (working in precision space is cleaner)</span>
<a id="__codelineno-22-54" name="__codelineno-22-54" href="#__codelineno-22-54"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mu</span> <span class="o">=</span> <span class="n">prior_mean</span>
<a id="__codelineno-22-55" name="__codelineno-22-55" href="#__codelineno-22-55"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">precision</span> <span class="o">=</span> <span class="n">prior_precision</span>          <span class="c1"># tau_0 = 1/sigma_0^2</span>
<a id="__codelineno-22-56" name="__codelineno-22-56" href="#__codelineno-22-56"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">noise_precision</span> <span class="o">=</span> <span class="n">known_noise_precision</span>  <span class="c1"># tau = 1/sigma^2</span>
<a id="__codelineno-22-57" name="__codelineno-22-57" href="#__codelineno-22-57"></a>
<a id="__codelineno-22-58" name="__codelineno-22-58" href="#__codelineno-22-58"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">observed_quality</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-22-59" name="__codelineno-22-59" href="#__codelineno-22-59"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Update posterior with a quality observation.&quot;&quot;&quot;</span>
<a id="__codelineno-22-60" name="__codelineno-22-60" href="#__codelineno-22-60"></a>        <span class="n">new_precision</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">precision</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise_precision</span>
<a id="__codelineno-22-61" name="__codelineno-22-61" href="#__codelineno-22-61"></a>        <span class="n">new_mu</span> <span class="o">=</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">precision</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">noise_precision</span> <span class="o">*</span> <span class="n">observed_quality</span><span class="p">)</span>
<a id="__codelineno-22-62" name="__codelineno-22-62" href="#__codelineno-22-62"></a>                  <span class="o">/</span> <span class="n">new_precision</span><span class="p">)</span>
<a id="__codelineno-22-63" name="__codelineno-22-63" href="#__codelineno-22-63"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">precision</span> <span class="o">=</span> <span class="n">new_precision</span>
<a id="__codelineno-22-64" name="__codelineno-22-64" href="#__codelineno-22-64"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mu</span> <span class="o">=</span> <span class="n">new_mu</span>
<a id="__codelineno-22-65" name="__codelineno-22-65" href="#__codelineno-22-65"></a>
<a id="__codelineno-22-66" name="__codelineno-22-66" href="#__codelineno-22-66"></a>    <span class="nd">@property</span>
<a id="__codelineno-22-67" name="__codelineno-22-67" href="#__codelineno-22-67"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-22-68" name="__codelineno-22-68" href="#__codelineno-22-68"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu</span>
<a id="__codelineno-22-69" name="__codelineno-22-69" href="#__codelineno-22-69"></a>
<a id="__codelineno-22-70" name="__codelineno-22-70" href="#__codelineno-22-70"></a>    <span class="nd">@property</span>
<a id="__codelineno-22-71" name="__codelineno-22-71" href="#__codelineno-22-71"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">variance</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-22-72" name="__codelineno-22-72" href="#__codelineno-22-72"></a>        <span class="k">return</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">precision</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">precision</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
<a id="__codelineno-22-73" name="__codelineno-22-73" href="#__codelineno-22-73"></a>
<a id="__codelineno-22-74" name="__codelineno-22-74" href="#__codelineno-22-74"></a>    <span class="nd">@property</span>
<a id="__codelineno-22-75" name="__codelineno-22-75" href="#__codelineno-22-75"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">std</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-22-76" name="__codelineno-22-76" href="#__codelineno-22-76"></a>        <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variance</span><span class="p">)</span>
<a id="__codelineno-22-77" name="__codelineno-22-77" href="#__codelineno-22-77"></a>
<a id="__codelineno-22-78" name="__codelineno-22-78" href="#__codelineno-22-78"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-22-79" name="__codelineno-22-79" href="#__codelineno-22-79"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Sample from posterior.&quot;&quot;&quot;</span>
<a id="__codelineno-22-80" name="__codelineno-22-80" href="#__codelineno-22-80"></a>        <span class="k">return</span> <span class="n">random</span><span class="o">.</span><span class="n">gauss</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mu</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">std</span><span class="p">)</span>
<a id="__codelineno-22-81" name="__codelineno-22-81" href="#__codelineno-22-81"></a>
<a id="__codelineno-22-82" name="__codelineno-22-82" href="#__codelineno-22-82"></a>    <span class="nd">@property</span>
<a id="__codelineno-22-83" name="__codelineno-22-83" href="#__codelineno-22-83"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">confidence_interval_95</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<a id="__codelineno-22-84" name="__codelineno-22-84" href="#__codelineno-22-84"></a>        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mu</span> <span class="o">-</span> <span class="mf">1.96</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">std</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mu</span> <span class="o">+</span> <span class="mf">1.96</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">std</span><span class="p">)</span>
<a id="__codelineno-22-85" name="__codelineno-22-85" href="#__codelineno-22-85"></a>
<a id="__codelineno-22-86" name="__codelineno-22-86" href="#__codelineno-22-86"></a>
<a id="__codelineno-22-87" name="__codelineno-22-87" href="#__codelineno-22-87"></a><span class="k">class</span><span class="w"> </span><span class="nc">DirichletMultinomialUpdater</span><span class="p">:</span>
<a id="__codelineno-22-88" name="__codelineno-22-88" href="#__codelineno-22-88"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-22-89" name="__codelineno-22-89" href="#__codelineno-22-89"></a><span class="sd">    Dirichlet-Multinomial conjugate pair for categorical choice modeling.</span>
<a id="__codelineno-22-90" name="__codelineno-22-90" href="#__codelineno-22-90"></a><span class="sd">    Useful for: model selection across task types, outcome type distributions.</span>
<a id="__codelineno-22-91" name="__codelineno-22-91" href="#__codelineno-22-91"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-22-92" name="__codelineno-22-92" href="#__codelineno-22-92"></a>
<a id="__codelineno-22-93" name="__codelineno-22-93" href="#__codelineno-22-93"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">categories</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">prior_counts</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<a id="__codelineno-22-94" name="__codelineno-22-94" href="#__codelineno-22-94"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">categories</span> <span class="o">=</span> <span class="n">categories</span>
<a id="__codelineno-22-95" name="__codelineno-22-95" href="#__codelineno-22-95"></a>        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">categories</span><span class="p">)</span>
<a id="__codelineno-22-96" name="__codelineno-22-96" href="#__codelineno-22-96"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">alphas</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-22-97" name="__codelineno-22-97" href="#__codelineno-22-97"></a>        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cat</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">categories</span><span class="p">):</span>
<a id="__codelineno-22-98" name="__codelineno-22-98" href="#__codelineno-22-98"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">alphas</span><span class="p">[</span><span class="n">cat</span><span class="p">]</span> <span class="o">=</span> <span class="n">prior_counts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">if</span> <span class="n">prior_counts</span> <span class="k">else</span> <span class="mf">1.0</span>
<a id="__codelineno-22-99" name="__codelineno-22-99" href="#__codelineno-22-99"></a>
<a id="__codelineno-22-100" name="__codelineno-22-100" href="#__codelineno-22-100"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">observed_category</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-22-101" name="__codelineno-22-101" href="#__codelineno-22-101"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Update posterior with an observed category.&quot;&quot;&quot;</span>
<a id="__codelineno-22-102" name="__codelineno-22-102" href="#__codelineno-22-102"></a>        <span class="k">if</span> <span class="n">observed_category</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">alphas</span><span class="p">:</span>
<a id="__codelineno-22-103" name="__codelineno-22-103" href="#__codelineno-22-103"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">alphas</span><span class="p">[</span><span class="n">observed_category</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1.0</span>
<a id="__codelineno-22-104" name="__codelineno-22-104" href="#__codelineno-22-104"></a>
<a id="__codelineno-22-105" name="__codelineno-22-105" href="#__codelineno-22-105"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_probabilities</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<a id="__codelineno-22-106" name="__codelineno-22-106" href="#__codelineno-22-106"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get expected probability for each category.&quot;&quot;&quot;</span>
<a id="__codelineno-22-107" name="__codelineno-22-107" href="#__codelineno-22-107"></a>        <span class="n">total</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alphas</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<a id="__codelineno-22-108" name="__codelineno-22-108" href="#__codelineno-22-108"></a>        <span class="k">return</span> <span class="p">{</span><span class="n">cat</span><span class="p">:</span> <span class="n">a</span> <span class="o">/</span> <span class="n">total</span> <span class="k">for</span> <span class="n">cat</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">alphas</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
<a id="__codelineno-22-109" name="__codelineno-22-109" href="#__codelineno-22-109"></a>
<a id="__codelineno-22-110" name="__codelineno-22-110" href="#__codelineno-22-110"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<a id="__codelineno-22-111" name="__codelineno-22-111" href="#__codelineno-22-111"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Sample a probability vector from the Dirichlet posterior.&quot;&quot;&quot;</span>
<a id="__codelineno-22-112" name="__codelineno-22-112" href="#__codelineno-22-112"></a>        <span class="n">samples</span> <span class="o">=</span> <span class="p">{</span><span class="n">cat</span><span class="p">:</span> <span class="n">random</span><span class="o">.</span><span class="n">gammavariate</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<a id="__codelineno-22-113" name="__codelineno-22-113" href="#__codelineno-22-113"></a>                   <span class="k">for</span> <span class="n">cat</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">alphas</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
<a id="__codelineno-22-114" name="__codelineno-22-114" href="#__codelineno-22-114"></a>        <span class="n">total</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">samples</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<a id="__codelineno-22-115" name="__codelineno-22-115" href="#__codelineno-22-115"></a>        <span class="k">return</span> <span class="p">{</span><span class="n">cat</span><span class="p">:</span> <span class="n">s</span> <span class="o">/</span> <span class="n">total</span> <span class="k">for</span> <span class="n">cat</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">samples</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span> <span class="k">if</span> <span class="n">total</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_probabilities</span><span class="p">()</span>
</code></pre></div>
<p><strong>Integration Point</strong>:
- <code>BetaDistribution</code>: <code>corteX/engine/weights.py</code>
  <code>ToolPreferenceWeights.success_rate</code> -&gt; replace with Beta posterior
- <code>GammaDistribution</code>: <code>corteX/engine/weights.py</code>
  <code>ToolPreferenceWeights.avg_latency_ms</code> -&gt; replace with Gamma posterior
- <code>NormalNormalUpdater</code>: <code>corteX/engine/prediction.py</code>
  <code>PredictionEngine._tool_stats["avg_quality"]</code> -&gt; replace with Normal posterior
- <code>DirichletMultinomialUpdater</code>: <code>corteX/core/llm/router.py</code>
  <code>LLMRouter._model_weights</code> -&gt; replace with Dirichlet posterior over task
  type affinities</p>
<h3 id="35-multi-armed-bandits-ucb1-alternative-to-thompson-sampling">3.5 Multi-Armed Bandits: UCB1 Alternative to Thompson Sampling<a class="headerlink" href="#35-multi-armed-bandits-ucb1-alternative-to-thompson-sampling" title="Permanent link">&para;</a></h3>
<p><strong>Theoretical Background</strong></p>
<p>While Thompson Sampling is Bayesian, the Upper Confidence Bound (UCB1) algorithm
provides a frequentist alternative with strong regret guarantees:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>UCB1 selection:
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>  Select arm j = argmax_j [ X_bar_j + sqrt(2 * ln(t) / n_j) ]
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a>Where:
<a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a>  X_bar_j = average reward of arm j
<a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a>  t = total number of rounds so far
<a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a>  n_j = number of times arm j has been played
</code></pre></div>
<p>The second term is the exploration bonus: it grows logarithmically with total
time (all arms become worth trying eventually) and decreases with the number
of times an arm has been played (well-explored arms need less exploration).</p>
<p><strong>Regret bound</strong>: O(sqrt(K * T * ln(T))) where K = number of arms, T = time.</p>
<p><strong>Concrete SDK Pattern: <code>UCB1Selector</code></strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">UCB1Selector</span><span class="p">:</span>
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="sd">    UCB1 algorithm for model/tool selection.</span>
<a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="sd">    Deterministic alternative to Thompson Sampling.</span>
<a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a><span class="sd">    Better when you need reproducible selection decisions.</span>
<a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a>
<a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exploration_weight</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">):</span>
<a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">c</span> <span class="o">=</span> <span class="n">exploration_weight</span>  <span class="c1"># Controls exploration-exploitation tradeoff</span>
<a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_avg_rewards</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-24-11" name="__codelineno-24-11" href="#__codelineno-24-11"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_counts</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-24-12" name="__codelineno-24-12" href="#__codelineno-24-12"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_total_rounds</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-24-13" name="__codelineno-24-13" href="#__codelineno-24-13"></a>
<a id="__codelineno-24-14" name="__codelineno-24-14" href="#__codelineno-24-14"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">register</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arm</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-24-15" name="__codelineno-24-15" href="#__codelineno-24-15"></a>        <span class="k">if</span> <span class="n">arm</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_avg_rewards</span><span class="p">:</span>
<a id="__codelineno-24-16" name="__codelineno-24-16" href="#__codelineno-24-16"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_avg_rewards</span><span class="p">[</span><span class="n">arm</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
<a id="__codelineno-24-17" name="__codelineno-24-17" href="#__codelineno-24-17"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_counts</span><span class="p">[</span><span class="n">arm</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-24-18" name="__codelineno-24-18" href="#__codelineno-24-18"></a>
<a id="__codelineno-24-19" name="__codelineno-24-19" href="#__codelineno-24-19"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arm</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">reward</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-24-20" name="__codelineno-24-20" href="#__codelineno-24-20"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Record reward for an arm.&quot;&quot;&quot;</span>
<a id="__codelineno-24-21" name="__codelineno-24-21" href="#__codelineno-24-21"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">arm</span><span class="p">)</span>
<a id="__codelineno-24-22" name="__codelineno-24-22" href="#__codelineno-24-22"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_counts</span><span class="p">[</span><span class="n">arm</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-24-23" name="__codelineno-24-23" href="#__codelineno-24-23"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_total_rounds</span> <span class="o">+=</span> <span class="mi">1</span>
<a id="__codelineno-24-24" name="__codelineno-24-24" href="#__codelineno-24-24"></a>        <span class="c1"># Incremental mean update</span>
<a id="__codelineno-24-25" name="__codelineno-24-25" href="#__codelineno-24-25"></a>        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_counts</span><span class="p">[</span><span class="n">arm</span><span class="p">]</span>
<a id="__codelineno-24-26" name="__codelineno-24-26" href="#__codelineno-24-26"></a>        <span class="n">old_avg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_avg_rewards</span><span class="p">[</span><span class="n">arm</span><span class="p">]</span>
<a id="__codelineno-24-27" name="__codelineno-24-27" href="#__codelineno-24-27"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_avg_rewards</span><span class="p">[</span><span class="n">arm</span><span class="p">]</span> <span class="o">=</span> <span class="n">old_avg</span> <span class="o">+</span> <span class="p">(</span><span class="n">reward</span> <span class="o">-</span> <span class="n">old_avg</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span>
<a id="__codelineno-24-28" name="__codelineno-24-28" href="#__codelineno-24-28"></a>
<a id="__codelineno-24-29" name="__codelineno-24-29" href="#__codelineno-24-29"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">select</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">candidates</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-24-30" name="__codelineno-24-30" href="#__codelineno-24-30"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Select arm using UCB1.&quot;&quot;&quot;</span>
<a id="__codelineno-24-31" name="__codelineno-24-31" href="#__codelineno-24-31"></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">candidates</span><span class="p">:</span>
<a id="__codelineno-24-32" name="__codelineno-24-32" href="#__codelineno-24-32"></a>            <span class="k">return</span> <span class="s2">&quot;&quot;</span>
<a id="__codelineno-24-33" name="__codelineno-24-33" href="#__codelineno-24-33"></a>
<a id="__codelineno-24-34" name="__codelineno-24-34" href="#__codelineno-24-34"></a>        <span class="c1"># First, play each arm at least once</span>
<a id="__codelineno-24-35" name="__codelineno-24-35" href="#__codelineno-24-35"></a>        <span class="k">for</span> <span class="n">arm</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
<a id="__codelineno-24-36" name="__codelineno-24-36" href="#__codelineno-24-36"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">arm</span><span class="p">)</span>
<a id="__codelineno-24-37" name="__codelineno-24-37" href="#__codelineno-24-37"></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_counts</span><span class="p">[</span><span class="n">arm</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-24-38" name="__codelineno-24-38" href="#__codelineno-24-38"></a>                <span class="k">return</span> <span class="n">arm</span>
<a id="__codelineno-24-39" name="__codelineno-24-39" href="#__codelineno-24-39"></a>
<a id="__codelineno-24-40" name="__codelineno-24-40" href="#__codelineno-24-40"></a>        <span class="c1"># UCB1 formula</span>
<a id="__codelineno-24-41" name="__codelineno-24-41" href="#__codelineno-24-41"></a>        <span class="n">best_arm</span> <span class="o">=</span> <span class="n">candidates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-24-42" name="__codelineno-24-42" href="#__codelineno-24-42"></a>        <span class="n">best_ucb</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;-inf&#39;</span><span class="p">)</span>
<a id="__codelineno-24-43" name="__codelineno-24-43" href="#__codelineno-24-43"></a>
<a id="__codelineno-24-44" name="__codelineno-24-44" href="#__codelineno-24-44"></a>        <span class="k">for</span> <span class="n">arm</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
<a id="__codelineno-24-45" name="__codelineno-24-45" href="#__codelineno-24-45"></a>            <span class="n">avg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_avg_rewards</span><span class="p">[</span><span class="n">arm</span><span class="p">]</span>
<a id="__codelineno-24-46" name="__codelineno-24-46" href="#__codelineno-24-46"></a>            <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_counts</span><span class="p">[</span><span class="n">arm</span><span class="p">]</span>
<a id="__codelineno-24-47" name="__codelineno-24-47" href="#__codelineno-24-47"></a>            <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_total_rounds</span>
<a id="__codelineno-24-48" name="__codelineno-24-48" href="#__codelineno-24-48"></a>            <span class="n">exploration_bonus</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span><span class="p">)</span>
<a id="__codelineno-24-49" name="__codelineno-24-49" href="#__codelineno-24-49"></a>            <span class="n">ucb_value</span> <span class="o">=</span> <span class="n">avg</span> <span class="o">+</span> <span class="n">exploration_bonus</span>
<a id="__codelineno-24-50" name="__codelineno-24-50" href="#__codelineno-24-50"></a>
<a id="__codelineno-24-51" name="__codelineno-24-51" href="#__codelineno-24-51"></a>            <span class="k">if</span> <span class="n">ucb_value</span> <span class="o">&gt;</span> <span class="n">best_ucb</span><span class="p">:</span>
<a id="__codelineno-24-52" name="__codelineno-24-52" href="#__codelineno-24-52"></a>                <span class="n">best_ucb</span> <span class="o">=</span> <span class="n">ucb_value</span>
<a id="__codelineno-24-53" name="__codelineno-24-53" href="#__codelineno-24-53"></a>                <span class="n">best_arm</span> <span class="o">=</span> <span class="n">arm</span>
<a id="__codelineno-24-54" name="__codelineno-24-54" href="#__codelineno-24-54"></a>
<a id="__codelineno-24-55" name="__codelineno-24-55" href="#__codelineno-24-55"></a>        <span class="k">return</span> <span class="n">best_arm</span>
<a id="__codelineno-24-56" name="__codelineno-24-56" href="#__codelineno-24-56"></a>
<a id="__codelineno-24-57" name="__codelineno-24-57" href="#__codelineno-24-57"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]:</span>
<a id="__codelineno-24-58" name="__codelineno-24-58" href="#__codelineno-24-58"></a>        <span class="k">return</span> <span class="p">{</span>
<a id="__codelineno-24-59" name="__codelineno-24-59" href="#__codelineno-24-59"></a>            <span class="n">arm</span><span class="p">:</span> <span class="p">{</span>
<a id="__codelineno-24-60" name="__codelineno-24-60" href="#__codelineno-24-60"></a>                <span class="s2">&quot;avg_reward&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_avg_rewards</span><span class="p">[</span><span class="n">arm</span><span class="p">],</span>
<a id="__codelineno-24-61" name="__codelineno-24-61" href="#__codelineno-24-61"></a>                <span class="s2">&quot;count&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_counts</span><span class="p">[</span><span class="n">arm</span><span class="p">],</span>
<a id="__codelineno-24-62" name="__codelineno-24-62" href="#__codelineno-24-62"></a>                <span class="s2">&quot;ucb_bonus&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_total_rounds</span><span class="p">))</span>
<a id="__codelineno-24-63" name="__codelineno-24-63" href="#__codelineno-24-63"></a>                              <span class="o">/</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_counts</span><span class="p">[</span><span class="n">arm</span><span class="p">]))),</span>
<a id="__codelineno-24-64" name="__codelineno-24-64" href="#__codelineno-24-64"></a>            <span class="p">}</span>
<a id="__codelineno-24-65" name="__codelineno-24-65" href="#__codelineno-24-65"></a>            <span class="k">for</span> <span class="n">arm</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_avg_rewards</span>
<a id="__codelineno-24-66" name="__codelineno-24-66" href="#__codelineno-24-66"></a>        <span class="p">}</span>
</code></pre></div>
<p><strong>Integration Point</strong>: <code>corteX/core/llm/router.py</code> <code>LLMRouter._select_model()</code>
-- can be used as alternative to Thompson Sampling when deterministic behavior
is preferred (e.g., in testing or when <code>enterprise.audit_logging = True</code>).</p>
<h3 id="36-bayesian-surprise-formalizing-the-prediction-error-signal">3.6 Bayesian Surprise: Formalizing the Prediction Error Signal<a class="headerlink" href="#36-bayesian-surprise-formalizing-the-prediction-error-signal" title="Permanent link">&para;</a></h3>
<p><strong>Theoretical Background</strong></p>
<p>Bayesian surprise (Itti &amp; Baldi, 2009) quantifies how much an observation
changes beliefs, measured as the KL divergence between prior and posterior:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>Surprise(data) = D_KL(posterior || prior)
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>               = integral [ posterior(theta) * log(posterior(theta) / prior(theta)) ] d_theta
</code></pre></div>
<p>For conjugate distributions, KL divergence has closed-form solutions:</p>
<p><strong>Beta-Beta KL divergence</strong> (for success rate surprise):
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>D_KL(Beta(a1,b1) || Beta(a2,b2)) =
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>    log(B(a2,b2)/B(a1,b1))
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>    + (a1-a2)*psi(a1) + (b1-b2)*psi(b1)
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a>    + (a2-a1+b2-b1)*psi(a1+b1)
</code></pre></div>
Where <code>psi</code> is the digamma function and <code>B</code> is the beta function.</p>
<p><strong>Normal-Normal KL divergence</strong> (for quality score surprise):
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>D_KL(N(mu1,s1^2) || N(mu2,s2^2)) =
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a>    log(s2/s1) + (s1^2 + (mu1-mu2)^2)/(2*s2^2) - 0.5
</code></pre></div></p>
<p><strong>Application to corteX</strong></p>
<p>The current <code>PredictionEngine.compare()</code> uses ad-hoc heuristics to compute
surprise. Bayesian surprise provides a principled replacement.</p>
<p><strong>Concrete SDK Pattern: <code>BayesianSurpriseCalculator</code></strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">BayesianSurpriseCalculator</span><span class="p">:</span>
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a><span class="sd">    Computes Bayesian surprise as KL divergence between</span>
<a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a><span class="sd">    prior and posterior distributions.</span>
<a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a>
<a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a><span class="sd">    This replaces the heuristic surprise computation in PredictionEngine</span>
<a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a><span class="sd">    with a principled information-theoretic measure.</span>
<a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-28-9" name="__codelineno-28-9" href="#__codelineno-28-9"></a>
<a id="__codelineno-28-10" name="__codelineno-28-10" href="#__codelineno-28-10"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-28-11" name="__codelineno-28-11" href="#__codelineno-28-11"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">beta_kl_divergence</span><span class="p">(</span><span class="n">post_alpha</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">post_beta</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-28-12" name="__codelineno-28-12" href="#__codelineno-28-12"></a>                           <span class="n">prior_alpha</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">prior_beta</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-28-13" name="__codelineno-28-13" href="#__codelineno-28-13"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-28-14" name="__codelineno-28-14" href="#__codelineno-28-14"></a><span class="sd">        KL divergence between two Beta distributions.</span>
<a id="__codelineno-28-15" name="__codelineno-28-15" href="#__codelineno-28-15"></a><span class="sd">        D_KL(Beta(post) || Beta(prior))</span>
<a id="__codelineno-28-16" name="__codelineno-28-16" href="#__codelineno-28-16"></a><span class="sd">        Measures how much the posterior differs from the prior.</span>
<a id="__codelineno-28-17" name="__codelineno-28-17" href="#__codelineno-28-17"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-28-18" name="__codelineno-28-18" href="#__codelineno-28-18"></a>        <span class="kn">from</span><span class="w"> </span><span class="nn">math</span><span class="w"> </span><span class="kn">import</span> <span class="n">lgamma</span>
<a id="__codelineno-28-19" name="__codelineno-28-19" href="#__codelineno-28-19"></a>        <span class="c1"># Using log-gamma for numerical stability</span>
<a id="__codelineno-28-20" name="__codelineno-28-20" href="#__codelineno-28-20"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">log_beta</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<a id="__codelineno-28-21" name="__codelineno-28-21" href="#__codelineno-28-21"></a>            <span class="k">return</span> <span class="n">lgamma</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="n">lgamma</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">-</span> <span class="n">lgamma</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span>
<a id="__codelineno-28-22" name="__codelineno-28-22" href="#__codelineno-28-22"></a>
<a id="__codelineno-28-23" name="__codelineno-28-23" href="#__codelineno-28-23"></a>        <span class="k">def</span><span class="w"> </span><span class="nf">digamma_approx</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<a id="__codelineno-28-24" name="__codelineno-28-24" href="#__codelineno-28-24"></a><span class="w">            </span><span class="sd">&quot;&quot;&quot;Stirling&#39;s approximation for digamma function.&quot;&quot;&quot;</span>
<a id="__codelineno-28-25" name="__codelineno-28-25" href="#__codelineno-28-25"></a>            <span class="c1"># psi(x) approx ln(x) - 1/(2x) for large x</span>
<a id="__codelineno-28-26" name="__codelineno-28-26" href="#__codelineno-28-26"></a>            <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">6</span><span class="p">:</span>
<a id="__codelineno-28-27" name="__codelineno-28-27" href="#__codelineno-28-27"></a>                <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mi">12</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>
<a id="__codelineno-28-28" name="__codelineno-28-28" href="#__codelineno-28-28"></a>            <span class="c1"># Recursion for small x: psi(x) = psi(x+1) - 1/x</span>
<a id="__codelineno-28-29" name="__codelineno-28-29" href="#__codelineno-28-29"></a>            <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-28-30" name="__codelineno-28-30" href="#__codelineno-28-30"></a>                <span class="k">return</span> <span class="mf">0.0</span>
<a id="__codelineno-28-31" name="__codelineno-28-31" href="#__codelineno-28-31"></a>            <span class="k">return</span> <span class="n">digamma_approx</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">x</span>
<a id="__codelineno-28-32" name="__codelineno-28-32" href="#__codelineno-28-32"></a>
<a id="__codelineno-28-33" name="__codelineno-28-33" href="#__codelineno-28-33"></a>        <span class="n">kl</span> <span class="o">=</span> <span class="p">(</span><span class="n">log_beta</span><span class="p">(</span><span class="n">prior_alpha</span><span class="p">,</span> <span class="n">prior_beta</span><span class="p">)</span>
<a id="__codelineno-28-34" name="__codelineno-28-34" href="#__codelineno-28-34"></a>              <span class="o">-</span> <span class="n">log_beta</span><span class="p">(</span><span class="n">post_alpha</span><span class="p">,</span> <span class="n">post_beta</span><span class="p">))</span>
<a id="__codelineno-28-35" name="__codelineno-28-35" href="#__codelineno-28-35"></a>        <span class="n">kl</span> <span class="o">+=</span> <span class="p">((</span><span class="n">post_alpha</span> <span class="o">-</span> <span class="n">prior_alpha</span><span class="p">)</span> <span class="o">*</span> <span class="n">digamma_approx</span><span class="p">(</span><span class="n">post_alpha</span><span class="p">)</span>
<a id="__codelineno-28-36" name="__codelineno-28-36" href="#__codelineno-28-36"></a>               <span class="o">+</span> <span class="p">(</span><span class="n">post_beta</span> <span class="o">-</span> <span class="n">prior_beta</span><span class="p">)</span> <span class="o">*</span> <span class="n">digamma_approx</span><span class="p">(</span><span class="n">post_beta</span><span class="p">))</span>
<a id="__codelineno-28-37" name="__codelineno-28-37" href="#__codelineno-28-37"></a>        <span class="n">kl</span> <span class="o">+=</span> <span class="p">((</span><span class="n">prior_alpha</span> <span class="o">-</span> <span class="n">post_alpha</span> <span class="o">+</span> <span class="n">prior_beta</span> <span class="o">-</span> <span class="n">post_beta</span><span class="p">)</span>
<a id="__codelineno-28-38" name="__codelineno-28-38" href="#__codelineno-28-38"></a>               <span class="o">*</span> <span class="n">digamma_approx</span><span class="p">(</span><span class="n">post_alpha</span> <span class="o">+</span> <span class="n">post_beta</span><span class="p">))</span>
<a id="__codelineno-28-39" name="__codelineno-28-39" href="#__codelineno-28-39"></a>
<a id="__codelineno-28-40" name="__codelineno-28-40" href="#__codelineno-28-40"></a>        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">kl</span><span class="p">)</span>  <span class="c1"># KL is non-negative</span>
<a id="__codelineno-28-41" name="__codelineno-28-41" href="#__codelineno-28-41"></a>
<a id="__codelineno-28-42" name="__codelineno-28-42" href="#__codelineno-28-42"></a>    <span class="nd">@staticmethod</span>
<a id="__codelineno-28-43" name="__codelineno-28-43" href="#__codelineno-28-43"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">normal_kl_divergence</span><span class="p">(</span><span class="n">post_mu</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">post_var</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-28-44" name="__codelineno-28-44" href="#__codelineno-28-44"></a>                             <span class="n">prior_mu</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">prior_var</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-28-45" name="__codelineno-28-45" href="#__codelineno-28-45"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-28-46" name="__codelineno-28-46" href="#__codelineno-28-46"></a><span class="sd">        KL divergence between two Normal distributions.</span>
<a id="__codelineno-28-47" name="__codelineno-28-47" href="#__codelineno-28-47"></a><span class="sd">        D_KL(N(post_mu, post_var) || N(prior_mu, prior_var))</span>
<a id="__codelineno-28-48" name="__codelineno-28-48" href="#__codelineno-28-48"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-28-49" name="__codelineno-28-49" href="#__codelineno-28-49"></a>        <span class="k">if</span> <span class="n">prior_var</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">post_var</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-28-50" name="__codelineno-28-50" href="#__codelineno-28-50"></a>            <span class="k">return</span> <span class="mf">0.0</span>
<a id="__codelineno-28-51" name="__codelineno-28-51" href="#__codelineno-28-51"></a>        <span class="k">return</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">prior_var</span> <span class="o">/</span> <span class="n">post_var</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
<a id="__codelineno-28-52" name="__codelineno-28-52" href="#__codelineno-28-52"></a>                <span class="o">+</span> <span class="p">(</span><span class="n">post_var</span> <span class="o">+</span> <span class="p">(</span><span class="n">post_mu</span> <span class="o">-</span> <span class="n">prior_mu</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">prior_var</span><span class="p">)</span>
<a id="__codelineno-28-53" name="__codelineno-28-53" href="#__codelineno-28-53"></a>                <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span>
<a id="__codelineno-28-54" name="__codelineno-28-54" href="#__codelineno-28-54"></a>
<a id="__codelineno-28-55" name="__codelineno-28-55" href="#__codelineno-28-55"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">compute_surprise</span><span class="p">(</span>
<a id="__codelineno-28-56" name="__codelineno-28-56" href="#__codelineno-28-56"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-28-57" name="__codelineno-28-57" href="#__codelineno-28-57"></a>        <span class="n">prior_params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
<a id="__codelineno-28-58" name="__codelineno-28-58" href="#__codelineno-28-58"></a>        <span class="n">posterior_params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
<a id="__codelineno-28-59" name="__codelineno-28-59" href="#__codelineno-28-59"></a>        <span class="n">distribution_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;beta&quot;</span><span class="p">,</span>
<a id="__codelineno-28-60" name="__codelineno-28-60" href="#__codelineno-28-60"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-28-61" name="__codelineno-28-61" href="#__codelineno-28-61"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-28-62" name="__codelineno-28-62" href="#__codelineno-28-62"></a><span class="sd">        Compute Bayesian surprise for a single observation.</span>
<a id="__codelineno-28-63" name="__codelineno-28-63" href="#__codelineno-28-63"></a><span class="sd">        Returns KL divergence in nats (natural log units).</span>
<a id="__codelineno-28-64" name="__codelineno-28-64" href="#__codelineno-28-64"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-28-65" name="__codelineno-28-65" href="#__codelineno-28-65"></a>        <span class="k">if</span> <span class="n">distribution_type</span> <span class="o">==</span> <span class="s2">&quot;beta&quot;</span><span class="p">:</span>
<a id="__codelineno-28-66" name="__codelineno-28-66" href="#__codelineno-28-66"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta_kl_divergence</span><span class="p">(</span>
<a id="__codelineno-28-67" name="__codelineno-28-67" href="#__codelineno-28-67"></a>                <span class="n">posterior_params</span><span class="p">[</span><span class="s2">&quot;alpha&quot;</span><span class="p">],</span> <span class="n">posterior_params</span><span class="p">[</span><span class="s2">&quot;beta&quot;</span><span class="p">],</span>
<a id="__codelineno-28-68" name="__codelineno-28-68" href="#__codelineno-28-68"></a>                <span class="n">prior_params</span><span class="p">[</span><span class="s2">&quot;alpha&quot;</span><span class="p">],</span> <span class="n">prior_params</span><span class="p">[</span><span class="s2">&quot;beta&quot;</span><span class="p">],</span>
<a id="__codelineno-28-69" name="__codelineno-28-69" href="#__codelineno-28-69"></a>            <span class="p">)</span>
<a id="__codelineno-28-70" name="__codelineno-28-70" href="#__codelineno-28-70"></a>        <span class="k">elif</span> <span class="n">distribution_type</span> <span class="o">==</span> <span class="s2">&quot;normal&quot;</span><span class="p">:</span>
<a id="__codelineno-28-71" name="__codelineno-28-71" href="#__codelineno-28-71"></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">normal_kl_divergence</span><span class="p">(</span>
<a id="__codelineno-28-72" name="__codelineno-28-72" href="#__codelineno-28-72"></a>                <span class="n">posterior_params</span><span class="p">[</span><span class="s2">&quot;mu&quot;</span><span class="p">],</span> <span class="n">posterior_params</span><span class="p">[</span><span class="s2">&quot;var&quot;</span><span class="p">],</span>
<a id="__codelineno-28-73" name="__codelineno-28-73" href="#__codelineno-28-73"></a>                <span class="n">prior_params</span><span class="p">[</span><span class="s2">&quot;mu&quot;</span><span class="p">],</span> <span class="n">prior_params</span><span class="p">[</span><span class="s2">&quot;var&quot;</span><span class="p">],</span>
<a id="__codelineno-28-74" name="__codelineno-28-74" href="#__codelineno-28-74"></a>            <span class="p">)</span>
<a id="__codelineno-28-75" name="__codelineno-28-75" href="#__codelineno-28-75"></a>        <span class="k">return</span> <span class="mf">0.0</span>
<a id="__codelineno-28-76" name="__codelineno-28-76" href="#__codelineno-28-76"></a>
<a id="__codelineno-28-77" name="__codelineno-28-77" href="#__codelineno-28-77"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">surprise_to_learning_signal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">surprise</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<a id="__codelineno-28-78" name="__codelineno-28-78" href="#__codelineno-28-78"></a>                                     <span class="n">max_surprise</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">5.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-28-79" name="__codelineno-28-79" href="#__codelineno-28-79"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-28-80" name="__codelineno-28-80" href="#__codelineno-28-80"></a><span class="sd">        Convert raw surprise (KL divergence) to a learning signal [0, 1].</span>
<a id="__codelineno-28-81" name="__codelineno-28-81" href="#__codelineno-28-81"></a><span class="sd">        Uses sigmoid-like scaling so extreme surprises don&#39;t cause instability.</span>
<a id="__codelineno-28-82" name="__codelineno-28-82" href="#__codelineno-28-82"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-28-83" name="__codelineno-28-83" href="#__codelineno-28-83"></a>        <span class="n">normalized</span> <span class="o">=</span> <span class="n">surprise</span> <span class="o">/</span> <span class="n">max_surprise</span>
<a id="__codelineno-28-84" name="__codelineno-28-84" href="#__codelineno-28-84"></a>        <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="n">normalized</span><span class="p">)</span>  <span class="c1"># Bounded [0, 1) for positive KL</span>
</code></pre></div>
<p><strong>Integration Point</strong>: <code>corteX/engine/prediction.py</code>
<code>PredictionEngine.compare()</code> -- replace the heuristic surprise computation
with <code>BayesianSurpriseCalculator</code>. Before each observation, snapshot the
prior parameters. After updating, compute KL divergence between prior
and posterior. This feeds directly into <code>corteX/engine/plasticity.py</code>
<code>PlasticityManager.on_step_complete()</code> through the <code>SurpriseSignal</code>.</p>
<hr />
<h2 id="integration-map">Integration Map<a class="headerlink" href="#integration-map" title="Permanent link">&para;</a></h2>
<h3 id="where-each-pattern-fits-in-the-cortex-codebase">Where Each Pattern Fits in the corteX Codebase<a class="headerlink" href="#where-each-pattern-fits-in-the-cortex-codebase" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a>corteX/engine/
<a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a>  |
<a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a>  +-- weights.py          &lt;-- ProspectTheoreticUpdater (1.2)
<a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a>  |                            AnchorManager (1.3)
<a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a>  |                            AvailabilityFilter (1.4)
<a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a>  |                            BayesianToolSelector (3.2)
<a id="__codelineno-29-7" name="__codelineno-29-7" href="#__codelineno-29-7"></a>  |                            BetaDistribution (3.4)
<a id="__codelineno-29-8" name="__codelineno-29-8" href="#__codelineno-29-8"></a>  |                            GammaDistribution (3.4)
<a id="__codelineno-29-9" name="__codelineno-29-9" href="#__codelineno-29-9"></a>  |
<a id="__codelineno-29-10" name="__codelineno-29-10" href="#__codelineno-29-10"></a>  +-- prediction.py       &lt;-- BayesianSurpriseCalculator (3.6)
<a id="__codelineno-29-11" name="__codelineno-29-11" href="#__codelineno-29-11"></a>  |                            NormalNormalUpdater (3.4)
<a id="__codelineno-29-12" name="__codelineno-29-12" href="#__codelineno-29-12"></a>  |
<a id="__codelineno-29-13" name="__codelineno-29-13" href="#__codelineno-29-13"></a>  +-- plasticity.py       &lt;-- ShapleyAttributor (2.4) for credit assignment
<a id="__codelineno-29-14" name="__codelineno-29-14" href="#__codelineno-29-14"></a>  |                            ReputationSystem (2.5) for trust-based LTP/LTD
<a id="__codelineno-29-15" name="__codelineno-29-15" href="#__codelineno-29-15"></a>  |
<a id="__codelineno-29-16" name="__codelineno-29-16" href="#__codelineno-29-16"></a>  +-- population.py       &lt;-- FrameNormalizer (1.5) for score normalization
<a id="__codelineno-29-17" name="__codelineno-29-17" href="#__codelineno-29-17"></a>  |
<a id="__codelineno-29-18" name="__codelineno-29-18" href="#__codelineno-29-18"></a>  +-- dual_process.py     &lt;-- DualProcessRouter (1.1)       [NEW FILE]
<a id="__codelineno-29-19" name="__codelineno-29-19" href="#__codelineno-29-19"></a>  |
<a id="__codelineno-29-20" name="__codelineno-29-20" href="#__codelineno-29-20"></a>  +-- bayesian.py         &lt;-- BetaDistribution              [NEW FILE]
<a id="__codelineno-29-21" name="__codelineno-29-21" href="#__codelineno-29-21"></a>  |                            GammaDistribution
<a id="__codelineno-29-22" name="__codelineno-29-22" href="#__codelineno-29-22"></a>  |                            NormalNormalUpdater
<a id="__codelineno-29-23" name="__codelineno-29-23" href="#__codelineno-29-23"></a>  |                            DirichletMultinomialUpdater
<a id="__codelineno-29-24" name="__codelineno-29-24" href="#__codelineno-29-24"></a>  |                            BayesianSurpriseCalculator
<a id="__codelineno-29-25" name="__codelineno-29-25" href="#__codelineno-29-25"></a>  |
<a id="__codelineno-29-26" name="__codelineno-29-26" href="#__codelineno-29-26"></a>  +-- game_theory.py      &lt;-- NashRoutingOptimizer (2.1)    [NEW FILE]
<a id="__codelineno-29-27" name="__codelineno-29-27" href="#__codelineno-29-27"></a>  |                            MinimaxSafetyGuard (2.2)
<a id="__codelineno-29-28" name="__codelineno-29-28" href="#__codelineno-29-28"></a>  |                            TruthfulScoringMechanism (2.3)
<a id="__codelineno-29-29" name="__codelineno-29-29" href="#__codelineno-29-29"></a>  |                            ShapleyAttributor (2.4)
<a id="__codelineno-29-30" name="__codelineno-29-30" href="#__codelineno-29-30"></a>  |                            ReputationSystem (2.5)
<a id="__codelineno-29-31" name="__codelineno-29-31" href="#__codelineno-29-31"></a>  |
<a id="__codelineno-29-32" name="__codelineno-29-32" href="#__codelineno-29-32"></a>  +-- tuning.py           &lt;-- SimpleBayesianOptimizer (3.3) [NEW FILE]
<a id="__codelineno-29-33" name="__codelineno-29-33" href="#__codelineno-29-33"></a>  |
<a id="__codelineno-29-34" name="__codelineno-29-34" href="#__codelineno-29-34"></a>  +-- bandits.py          &lt;-- UCB1Selector (3.5)            [NEW FILE]
<a id="__codelineno-29-35" name="__codelineno-29-35" href="#__codelineno-29-35"></a>  |                            BayesianToolSelector (3.2)
<a id="__codelineno-29-36" name="__codelineno-29-36" href="#__codelineno-29-36"></a>
<a id="__codelineno-29-37" name="__codelineno-29-37" href="#__codelineno-29-37"></a>corteX/core/llm/
<a id="__codelineno-29-38" name="__codelineno-29-38" href="#__codelineno-29-38"></a>  +-- router.py           &lt;-- NashRoutingOptimizer integration
<a id="__codelineno-29-39" name="__codelineno-29-39" href="#__codelineno-29-39"></a>  |                            UCB1Selector / ThompsonSampling for model selection
<a id="__codelineno-29-40" name="__codelineno-29-40" href="#__codelineno-29-40"></a>  |                            DirichletMultinomialUpdater for task-model routing
<a id="__codelineno-29-41" name="__codelineno-29-41" href="#__codelineno-29-41"></a>
<a id="__codelineno-29-42" name="__codelineno-29-42" href="#__codelineno-29-42"></a>corteX/runtime/
<a id="__codelineno-29-43" name="__codelineno-29-43" href="#__codelineno-29-43"></a>  +-- orchestrator.py     &lt;-- DualProcessRouter integration
<a id="__codelineno-29-44" name="__codelineno-29-44" href="#__codelineno-29-44"></a>  |                            MinimaxSafetyGuard for enterprise decisions
</code></pre></div>
<h3 id="data-flow">Data Flow<a class="headerlink" href="#data-flow" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a>User Request
<a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a>    |
<a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a>    v
<a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a>DualProcessRouter (1.1)  -- Decide fast/slow path
<a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a>    |
<a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a>    +--[System 1]--&gt; PopulationDecoder + FrameNormalizer (1.5)
<a id="__codelineno-30-7" name="__codelineno-30-7" href="#__codelineno-30-7"></a>    |                    |
<a id="__codelineno-30-8" name="__codelineno-30-8" href="#__codelineno-30-8"></a>    |                    v
<a id="__codelineno-30-9" name="__codelineno-30-9" href="#__codelineno-30-9"></a>    |                BayesianToolSelector (3.2) or UCB1Selector (3.5)
<a id="__codelineno-30-10" name="__codelineno-30-10" href="#__codelineno-30-10"></a>    |                    |
<a id="__codelineno-30-11" name="__codelineno-30-11" href="#__codelineno-30-11"></a>    |                    v
<a id="__codelineno-30-12" name="__codelineno-30-12" href="#__codelineno-30-12"></a>    |                Tool Execution
<a id="__codelineno-30-13" name="__codelineno-30-13" href="#__codelineno-30-13"></a>    |
<a id="__codelineno-30-14" name="__codelineno-30-14" href="#__codelineno-30-14"></a>    +--[System 2]--&gt; LLMRouter with NashRoutingOptimizer (2.1)
<a id="__codelineno-30-15" name="__codelineno-30-15" href="#__codelineno-30-15"></a>                         |
<a id="__codelineno-30-16" name="__codelineno-30-16" href="#__codelineno-30-16"></a>                         v
<a id="__codelineno-30-17" name="__codelineno-30-17" href="#__codelineno-30-17"></a>                     Full LLM Reasoning (thinking=True)
<a id="__codelineno-30-18" name="__codelineno-30-18" href="#__codelineno-30-18"></a>                         |
<a id="__codelineno-30-19" name="__codelineno-30-19" href="#__codelineno-30-19"></a>                         v
<a id="__codelineno-30-20" name="__codelineno-30-20" href="#__codelineno-30-20"></a>                     Tool Execution
<a id="__codelineno-30-21" name="__codelineno-30-21" href="#__codelineno-30-21"></a>    |
<a id="__codelineno-30-22" name="__codelineno-30-22" href="#__codelineno-30-22"></a>    v
<a id="__codelineno-30-23" name="__codelineno-30-23" href="#__codelineno-30-23"></a>Outcome Observation
<a id="__codelineno-30-24" name="__codelineno-30-24" href="#__codelineno-30-24"></a>    |
<a id="__codelineno-30-25" name="__codelineno-30-25" href="#__codelineno-30-25"></a>    +-- BetaDistribution.update() (3.4) -- success/failure posterior
<a id="__codelineno-30-26" name="__codelineno-30-26" href="#__codelineno-30-26"></a>    +-- GammaDistribution.update() (3.4) -- latency posterior
<a id="__codelineno-30-27" name="__codelineno-30-27" href="#__codelineno-30-27"></a>    +-- NormalNormalUpdater.update() (3.4) -- quality posterior
<a id="__codelineno-30-28" name="__codelineno-30-28" href="#__codelineno-30-28"></a>    +-- ProspectTheoreticUpdater (1.2) -- loss-aversive weight update
<a id="__codelineno-30-29" name="__codelineno-30-29" href="#__codelineno-30-29"></a>    +-- ReputationSystem.record() (2.5) -- trust update
<a id="__codelineno-30-30" name="__codelineno-30-30" href="#__codelineno-30-30"></a>    +-- BayesianSurpriseCalculator (3.6) -- compute surprise signal
<a id="__codelineno-30-31" name="__codelineno-30-31" href="#__codelineno-30-31"></a>    |
<a id="__codelineno-30-32" name="__codelineno-30-32" href="#__codelineno-30-32"></a>    v
<a id="__codelineno-30-33" name="__codelineno-30-33" href="#__codelineno-30-33"></a>PlasticityManager
<a id="__codelineno-30-34" name="__codelineno-30-34" href="#__codelineno-30-34"></a>    |
<a id="__codelineno-30-35" name="__codelineno-30-35" href="#__codelineno-30-35"></a>    +-- HebbianRule with ShapleyAttributor (2.4)
<a id="__codelineno-30-36" name="__codelineno-30-36" href="#__codelineno-30-36"></a>    +-- LTP/LTD with ReputationSystem (2.5)
<a id="__codelineno-30-37" name="__codelineno-30-37" href="#__codelineno-30-37"></a>    +-- HomeostaticRegulation
<a id="__codelineno-30-38" name="__codelineno-30-38" href="#__codelineno-30-38"></a>    |
<a id="__codelineno-30-39" name="__codelineno-30-39" href="#__codelineno-30-39"></a>    v
<a id="__codelineno-30-40" name="__codelineno-30-40" href="#__codelineno-30-40"></a>Consolidation (session end)
<a id="__codelineno-30-41" name="__codelineno-30-41" href="#__codelineno-30-41"></a>    |
<a id="__codelineno-30-42" name="__codelineno-30-42" href="#__codelineno-30-42"></a>    +-- NashRoutingOptimizer.iterate() (2.1)
<a id="__codelineno-30-43" name="__codelineno-30-43" href="#__codelineno-30-43"></a>    +-- SimpleBayesianOptimizer.suggest() (3.3) -- tuning
<a id="__codelineno-30-44" name="__codelineno-30-44" href="#__codelineno-30-44"></a>    +-- TruthfulScoringMechanism.credibility_score() (2.3)
<a id="__codelineno-30-45" name="__codelineno-30-45" href="#__codelineno-30-45"></a>    +-- WeightEngine.consolidate()
</code></pre></div>
<hr />
<h2 id="priority-ranking">Priority Ranking<a class="headerlink" href="#priority-ranking" title="Permanent link">&para;</a></h2>
<h3 id="impact-vs-complexity-matrix">Impact vs. Complexity Matrix<a class="headerlink" href="#impact-vs-complexity-matrix" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>#</th>
<th>Pattern</th>
<th>Impact</th>
<th>Complexity</th>
<th>Priority</th>
<th>Rationale</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td><strong>BetaDistribution + Thompson Sampling</strong> (3.2, 3.4)</td>
<td>Very High</td>
<td>Low</td>
<td>P0</td>
<td>Direct replacement for EMA. Adds exploration, uncertainty. Minimal code change.</td>
</tr>
<tr>
<td>2</td>
<td><strong>ProspectTheoreticUpdater</strong> (1.2)</td>
<td>High</td>
<td>Low</td>
<td>P0</td>
<td>Simple formula change in weight updates. Immediately improves failure handling.</td>
</tr>
<tr>
<td>3</td>
<td><strong>BayesianSurpriseCalculator</strong> (3.6)</td>
<td>High</td>
<td>Medium</td>
<td>P1</td>
<td>Replaces heuristic surprise with principled KL divergence. Requires posterior tracking.</td>
</tr>
<tr>
<td>4</td>
<td><strong>DualProcessRouter</strong> (1.1)</td>
<td>High</td>
<td>Medium</td>
<td>P1</td>
<td>Reduces unnecessary LLM calls. Requires integration with orchestrator.</td>
</tr>
<tr>
<td>5</td>
<td><strong>ReputationSystem</strong> (2.5)</td>
<td>High</td>
<td>Low</td>
<td>P1</td>
<td>Adds trust dynamics and quarantine. Simple data structure addition.</td>
</tr>
<tr>
<td>6</td>
<td><strong>UCB1Selector</strong> (3.5)</td>
<td>Medium</td>
<td>Low</td>
<td>P1</td>
<td>Deterministic alternative to Thompson. Good for enterprise/audit.</td>
</tr>
<tr>
<td>7</td>
<td><strong>GammaDistribution</strong> (3.4)</td>
<td>Medium</td>
<td>Low</td>
<td>P2</td>
<td>Better latency modeling. Drop-in replacement for EMA.</td>
</tr>
<tr>
<td>8</td>
<td><strong>AvailabilityFilter</strong> (1.4)</td>
<td>Medium</td>
<td>Low</td>
<td>P2</td>
<td>Controlled recency bias. Integrates with existing adaptation.</td>
</tr>
<tr>
<td>9</td>
<td><strong>MinimaxSafetyGuard</strong> (2.2)</td>
<td>Medium</td>
<td>Low</td>
<td>P2</td>
<td>Enterprise safety feature. Simple threshold logic.</td>
</tr>
<tr>
<td>10</td>
<td><strong>AnchorManager</strong> (1.3)</td>
<td>Medium</td>
<td>Low</td>
<td>P2</td>
<td>Better initialization. Needs global weight data to be useful.</td>
</tr>
<tr>
<td>11</td>
<td><strong>NashRoutingOptimizer</strong> (2.1)</td>
<td>Medium</td>
<td>Medium</td>
<td>P3</td>
<td>Sophisticated but requires multi-model setup to be useful.</td>
</tr>
<tr>
<td>12</td>
<td><strong>ShapleyAttributor</strong> (2.4)</td>
<td>Medium</td>
<td>High</td>
<td>P3</td>
<td>Fair attribution. O(2^N) complexity, needs Monte Carlo for scale.</td>
</tr>
<tr>
<td>13</td>
<td><strong>TruthfulScoringMechanism</strong> (2.3)</td>
<td>Low-Med</td>
<td>Medium</td>
<td>P3</td>
<td>Mechanism design. Value increases with more tools in ecosystem.</td>
</tr>
<tr>
<td>14</td>
<td><strong>FrameNormalizer</strong> (1.5)</td>
<td>Low</td>
<td>Low</td>
<td>P3</td>
<td>Nice-to-have normalization. Easy to add when needed.</td>
</tr>
<tr>
<td>15</td>
<td><strong>SimpleBayesianOptimizer</strong> (3.3)</td>
<td>High</td>
<td>High</td>
<td>P4</td>
<td>Hyperparameter tuning. Needs significant data/sessions. Long-term value.</td>
</tr>
<tr>
<td>16</td>
<td><strong>NormalNormalUpdater</strong> (3.4)</td>
<td>Medium</td>
<td>Low</td>
<td>P2</td>
<td>Quality score modeling. Drop-in replacement.</td>
</tr>
<tr>
<td>17</td>
<td><strong>DirichletMultinomialUpdater</strong> (3.4)</td>
<td>Medium</td>
<td>Medium</td>
<td>P3</td>
<td>Task-type distribution modeling. Needs multi-model routing.</td>
</tr>
</tbody>
</table>
<h3 id="recommended-implementation-order">Recommended Implementation Order<a class="headerlink" href="#recommended-implementation-order" title="Permanent link">&para;</a></h3>
<p><strong>Phase 1 (P0) -- Foundation</strong>: Beta posteriors + Thompson Sampling + Prospect Theory
- Replace EMA with <code>BetaDistribution</code> for success rates
- Add <code>ProspectTheoreticUpdater</code> for asymmetric updates
- Add <code>BayesianToolSelector</code> using Thompson Sampling
- Estimated effort: 2-3 days, ~200 lines of new code</p>
<p><strong>Phase 2 (P1) -- Intelligence</strong>: Bayesian Surprise + Dual Process + Reputation
- Add <code>BayesianSurpriseCalculator</code> replacing heuristic surprise
- Add <code>DualProcessRouter</code> for System 1/2 routing
- Add <code>ReputationSystem</code> for trust dynamics
- Add <code>UCB1Selector</code> as deterministic alternative
- Estimated effort: 3-5 days, ~400 lines of new code</p>
<p><strong>Phase 3 (P2) -- Refinement</strong>: Latency modeling + Safety + Availability
- Add <code>GammaDistribution</code> for latency posteriors
- Add <code>NormalNormalUpdater</code> for quality posteriors
- Add <code>MinimaxSafetyGuard</code> for enterprise decisions
- Add <code>AvailabilityFilter</code> for controlled recency bias
- Add <code>AnchorManager</code> for informed initialization
- Estimated effort: 3-4 days, ~350 lines of new code</p>
<p><strong>Phase 4 (P3) -- Ecosystem</strong>: Game Theory + Attribution
- Add <code>NashRoutingOptimizer</code> for multi-model routing
- Add <code>ShapleyAttributor</code> for credit assignment
- Add <code>TruthfulScoringMechanism</code> for honest capability reporting
- Add <code>DirichletMultinomialUpdater</code> for task-type modeling
- Add <code>FrameNormalizer</code> for score normalization
- Estimated effort: 5-7 days, ~500 lines of new code</p>
<p><strong>Phase 5 (P4) -- Meta-optimization</strong>: Bayesian Hyperparameter Tuning
- Add <code>SimpleBayesianOptimizer</code> for hyperparameter tuning
- Requires accumulated session data for meaningful optimization
- Estimated effort: 3-4 days, ~200 lines of new code</p>
<hr />
<h2 id="mathematical-reference-key-formulas">Mathematical Reference: Key Formulas<a class="headerlink" href="#mathematical-reference-key-formulas" title="Permanent link">&para;</a></h2>
<h3 id="prospect-theory-value-function">Prospect Theory Value Function<a class="headerlink" href="#prospect-theory-value-function" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>v(x) = x^0.88                    if x &gt;= 0 (gain)
<a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a>v(x) = -2.25 * |x|^0.88         if x &lt; 0  (loss)
</code></pre></div>
<h3 id="beta-bernoulli-posterior-update">Beta-Bernoulli Posterior Update<a class="headerlink" href="#beta-bernoulli-posterior-update" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a>Prior: Beta(alpha, beta)
<a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a>Observation: success (s=1) or failure (s=0)
<a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a>Posterior: Beta(alpha + s, beta + 1 - s)
<a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a>Mean: alpha / (alpha + beta)
</code></pre></div>
<h3 id="thompson-sampling-selection">Thompson Sampling Selection<a class="headerlink" href="#thompson-sampling-selection" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a>For each tool i:
<a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a>  theta_i ~ Beta(alpha_i, beta_i)    # Sample from posterior
<a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a>Select tool j = argmax_i theta_i     # Pick highest sample
</code></pre></div>
<h3 id="ucb1-selection">UCB1 Selection<a class="headerlink" href="#ucb1-selection" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a>Select arm j = argmax_j [ X_bar_j + sqrt(2 * ln(t) / n_j) ]
</code></pre></div>
<h3 id="bayesian-surprise-kl-divergence">Bayesian Surprise (KL Divergence)<a class="headerlink" href="#bayesian-surprise-kl-divergence" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a>Surprise = D_KL(posterior || prior)
<a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a>For Beta: D_KL(Beta(a1,b1) || Beta(a2,b2))
<a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a>For Normal: D_KL(N(mu1,s1^2) || N(mu2,s2^2)) = log(s2/s1) + (s1^2 + (mu1-mu2)^2)/(2*s2^2) - 0.5
</code></pre></div>
<h3 id="shapley-value">Shapley Value<a class="headerlink" href="#shapley-value" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a>phi_i = sum_{S subset N\{i}} [|S|!(|N|-|S|-1)! / |N|!] * [v(S u {i}) - v(S)]
</code></pre></div>
<h3 id="nash-equilibrium-best-response">Nash Equilibrium Best Response<a class="headerlink" href="#nash-equilibrium-best-response" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a>BR_i(sigma_{-i}) = argmax_{sigma_i} U_i(sigma_i, sigma_{-i})
<a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a>NE: sigma_i = BR_i(sigma_{-i}) for all i
</code></pre></div>
<h3 id="expected-improvement-bayesian-optimization">Expected Improvement (Bayesian Optimization)<a class="headerlink" href="#expected-improvement-bayesian-optimization" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a>EI(x) = (mu(x) - f_best) * Phi(Z) + sigma(x) * phi(Z)
<a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a>Z = (mu(x) - f_best) / sigma(x)
</code></pre></div>
<h3 id="gamma-exponential-posterior-update">Gamma-Exponential Posterior Update<a class="headerlink" href="#gamma-exponential-posterior-update" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a>Prior: Gamma(shape, rate)
<a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a>Observation: latency x_i (Exponential distributed)
<a id="__codelineno-39-3" name="__codelineno-39-3" href="#__codelineno-39-3"></a>Posterior: Gamma(shape + 1, rate + x_i)
<a id="__codelineno-39-4" name="__codelineno-39-4" href="#__codelineno-39-4"></a>Expected latency: shape / rate
</code></pre></div>
<hr />
<h2 id="references">References<a class="headerlink" href="#references" title="Permanent link">&para;</a></h2>
<h3 id="kahnemans-decision-theory">Kahneman's Decision Theory<a class="headerlink" href="#kahnemans-decision-theory" title="Permanent link">&para;</a></h3>
<ul>
<li>Kahneman, D. (2011). <em>Thinking, Fast and Slow</em>. Farrar, Straus and Giroux.</li>
<li>Kahneman, D. &amp; Tversky, A. (1979). "Prospect Theory: An Analysis of Decision under Risk." <em>Econometrica</em>, 47(2), 263-291.</li>
<li>Tversky, A. &amp; Kahneman, D. (1992). "Advances in prospect theory: Cumulative representation of uncertainty." <em>Journal of Risk and Uncertainty</em>, 5(4), 297-323.</li>
<li>Tversky, A. &amp; Kahneman, D. (1974). "Judgment under Uncertainty: Heuristics and Biases." <em>Science</em>, 185(4157), 1124-1131.</li>
</ul>
<h3 id="game-theory">Game Theory<a class="headerlink" href="#game-theory" title="Permanent link">&para;</a></h3>
<ul>
<li>Nash, J. (1950). "Equilibrium Points in N-person Games." <em>Proceedings of the National Academy of Sciences</em>, 36(1), 48-49.</li>
<li>Von Neumann, J. &amp; Morgenstern, O. (1944). <em>Theory of Games and Economic Behavior</em>. Princeton University Press.</li>
<li>Shapley, L. S. (1953). "A Value for N-person Games." <em>Contributions to the Theory of Games</em>, 2, 307-317.</li>
<li>Axelrod, R. (1984). <em>The Evolution of Cooperation</em>. Basic Books.</li>
<li>Myerson, R. B. (1981). "Optimal Auction Design." <em>Mathematics of Operations Research</em>, 6(1), 58-73.</li>
<li>Harsanyi, J. C. (1967-68). "Games with Incomplete Information Played by Bayesian Players." <em>Management Science</em>, Parts I-III.</li>
</ul>
<h3 id="bayesian-mathematics">Bayesian Mathematics<a class="headerlink" href="#bayesian-mathematics" title="Permanent link">&para;</a></h3>
<ul>
<li>Thompson, W. R. (1933). "On the Likelihood that One Unknown Probability Exceeds Another." <em>Biometrika</em>, 25(3-4), 285-294.</li>
<li>Russo, D. et al. (2018). "A Tutorial on Thompson Sampling." <em>Foundations and Trends in Machine Learning</em>, 11(1), 1-96.</li>
<li>Auer, P., Cesa-Bianchi, N. &amp; Fischer, P. (2002). "Finite-time Analysis of the Multiarmed Bandit Problem." <em>Machine Learning</em>, 47(2), 235-256.</li>
<li>Itti, L. &amp; Baldi, P. (2009). "Bayesian Surprise Attracts Human Attention." <em>Vision Research</em>, 49(10), 1295-1306.</li>
</ul>
<h3 id="computational-neuroscience">Computational Neuroscience<a class="headerlink" href="#computational-neuroscience" title="Permanent link">&para;</a></h3>
<ul>
<li>Friston, K. (2010). "The Free-Energy Principle: A Unified Brain Theory?" <em>Nature Reviews Neuroscience</em>, 11(2), 127-138.</li>
<li>Doya, K. (2007). <em>Bayesian Brain: Probabilistic Approaches to Neural Coding</em>. MIT Press.</li>
</ul>
<h3 id="applied-research-2025-2026">Applied Research (2025-2026)<a class="headerlink" href="#applied-research-2025-2026" title="Permanent link">&para;</a></h3>
<ul>
<li>De La Fuente, N. et al. (2024). "Game Theory and Multi-Agent Reinforcement Learning: From Nash Equilibria to Evolutionary Dynamics." arXiv:2412.20523.</li>
<li>"Game-Theoretic Lens on LLM-based Multi-Agent Systems." arXiv:2601.15047 (2026).</li>
<li>"Learning, Reasoning, Refinement: A Framework for Kahneman's Dual-System Intelligence in GUI Agents." arXiv:2506.17913 (2025).</li>
</ul>
<hr />
<p><em>This research document was prepared for the corteX project. Complexity creates intelligence -- these mathematical foundations provide the rigorous backbone for the brain-inspired weight engine to evolve from heuristic-driven to principled probabilistic reasoning.</em></p>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.indexes", "toc.follow", "search.suggest", "search.highlight", "content.code.copy", "content.tabs.link", "content.code.annotate"], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>